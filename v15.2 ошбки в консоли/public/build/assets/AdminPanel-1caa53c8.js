import{_ as Qt,g as S,o as pe,n as T,a as g,c as f,b as n,F as L,l as z,t as m,q as mt,j as X,k as ut,m as $,z as jo,A as $e,r as re,i as No,s as ft,B as Vo,d as Ut,w as Ie,C as Ro,h as Lt,f as Be,v as bt,e as zt,D as Uo,p as Lo,E as Xe,G as zo,y as $o}from"./main-af704050.js";const Bo={class:"marketplace-manager"},Xo={class:"mb-8"},Yo={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},qo={class:"flex items-center justify-between mb-3"},Go={class:"text-lg font-medium text-white"},Ho={class:"space-y-2 text-sm"},Wo={class:"flex justify-between"},Qo={class:"text-white"},Ko={class:"flex justify-between"},Zo={class:"text-white"},Jo={class:"mt-4 space-y-2"},tn=["onClick"],en=["onClick","disabled"],on={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},nn={class:"bg-gray-800 rounded-lg p-6"},rn={key:0,class:"space-y-3"},sn={class:"flex justify-between"},an={class:"text-white"},ln={class:"flex justify-between"},dn={class:"text-white"},un={class:"flex justify-between"},cn={class:"text-red-400"},gn={class:"flex justify-between"},fn={class:"text-yellow-400"},mn={key:1,class:"text-gray-500 text-center py-8"},pn={class:"bg-gray-800 rounded-lg p-6"},hn={key:0,class:"space-y-3 max-h-64 overflow-y-auto"},bn={class:"flex justify-between items-start"},vn={class:"text-white text-sm"},yn={class:"text-gray-500 text-xs"},xn={key:1,class:"text-gray-500 text-center py-8"},_n={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},wn={class:"bg-gray-800 rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto"},kn={class:"flex justify-between items-center mb-4"},Cn={class:"text-xl font-semibold text-white"},En={class:"bg-gray-700 rounded-lg p-4 mb-6"},Sn={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Dn=["value"],Mn=["value"],Tn={class:"flex items-end"},An=["disabled"],In={key:0,class:"space-y-2"},On={class:"text-white"},Fn={class:"text-white"},Pn=["onClick"],jn={key:1,class:"text-gray-500 text-center py-4"},Nn={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Vn={class:"bg-gray-800 rounded-lg p-6 max-w-2xl w-full"},Rn={class:"space-y-3"},Un={class:"flex justify-between"},Ln={class:"text-green-400 font-semibold"},zn={class:"flex justify-between"},$n={class:"text-red-400 font-semibold"},Bn={key:0,class:"mt-4"},Xn={class:"bg-gray-700 rounded-lg p-3 max-h-48 overflow-y-auto"},Yn={class:"text-red-400"},qn={class:"text-gray-300 ml-2"},Gn={class:"mt-6 flex justify-end"},Hn={__name:"MarketplaceManager",setup(o){const t=S([]),r=S(null),e=S(null),a=S([]),l=S([]),s=S([]),d=S([]),u=S(!1),c=S(!1),b=S(null),i=S(!1),y=S({}),C=S({our_attr_id:"",marketplace_attr_name:""});pe(()=>{A(),_()});const A=async()=>{try{const N=await T.get("/admin/marketplace");t.value=N.data.marketplaces}catch(N){console.error("Ошибка загрузки маркетплейсов:",N)}},_=async()=>{try{const N=await T.get("/admin/marketplace/sync-log");a.value=N.data.logs}catch(N){console.error("Ошибка загрузки логов:",N)}},x=async N=>{b.value=N,u.value=!0;try{const p=await T.get(`/admin/marketplace/${N}/mappings`);l.value=p.data.mappings,s.value=p.data.our_attributes,d.value=p.data.marketplace_attributes}catch(p){console.error("Ошибка загрузки маппингов:",p)}},I=()=>{u.value=!1,b.value=null,C.value={our_attr_id:"",marketplace_attr_name:""}},F=async()=>{try{await T.post("/admin/marketplace/mapping",{marketplace:b.value,our_attr_id:C.value.our_attr_id,marketplace_attr_name:C.value.marketplace_attr_name}),x(b.value),C.value={our_attr_id:"",marketplace_attr_name:""}}catch(N){console.error("Ошибка сохранения маппинга:",N),alert("Ошибка сохранения маппинга")}},P=async N=>{if(confirm("Удалить этот маппинг?"))try{await T.delete(`/admin/marketplace/mapping/${N}`),x(b.value)}catch(p){console.error("Ошибка удаления маппинга:",p),alert("Ошибка удаления маппинга")}},w=async N=>{var p,k;if(confirm("Начать синхронизацию всех товаров с маркетплейсом?")){i.value=!0;try{const B=await T.post("/admin/marketplace/sync",{marketplace:N});y.value=B.data.results,c.value=!0,A(),_()}catch(B){console.error("Ошибка синхронизации:",B),alert("Ошибка синхронизации: "+((k=(p=B.response)==null?void 0:p.data)==null?void 0:k.error)||B.message)}finally{i.value=!1}}},E=N=>N?new Date(N).toLocaleString("ru-RU"):"Никогда",j=N=>{const p=t.value.find(k=>k.id===N);return(p==null?void 0:p.name)||N},Q=N=>{const p=d.value.find(k=>k.id===N);return(p==null?void 0:p.name)||N};return(N,p)=>(g(),f("div",Bo,[n("div",Xo,[p[5]||(p[5]=n("h2",{class:"text-xl font-semibold text-white mb-4"},"Маркетплейсы",-1)),n("div",Yo,[(g(!0),f(L,null,z(t.value,k=>(g(),f("div",{key:k.id,class:"bg-gray-800 rounded-lg p-4 border border-gray-700"},[n("div",qo,[n("h3",Go,m(k.name),1),n("span",{class:mt(["px-2 py-1 rounded text-xs font-medium",k.configured?"bg-green-600 text-green-100":"bg-red-600 text-red-100"])},m(k.configured?"Настроен":"Не настроен"),3)]),n("div",Ho,[n("div",Wo,[p[3]||(p[3]=n("span",{class:"text-gray-400"},"Товаров синхронизировано:",-1)),n("span",Qo,m(k.products_count),1)]),n("div",Ko,[p[4]||(p[4]=n("span",{class:"text-gray-400"},"Последняя синхронизация:",-1)),n("span",Zo,m(E(k.last_sync)),1)])]),n("div",Jo,[n("button",{onClick:B=>x(k.id),class:"w-full bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded text-sm transition-colors"}," Настроить маппинг ",8,tn),n("button",{onClick:B=>w(k.id),disabled:!k.configured||i.value,class:"w-full bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},m(i.value?"Синхронизация...":"Синхронизировать"),9,en)])]))),128))])]),n("div",on,[n("div",nn,[p[10]||(p[10]=n("h3",{class:"text-lg font-medium text-white mb-4"},"Статистика синхронизации",-1)),r.value&&e.value?(g(),f("div",rn,[n("div",sn,[p[6]||(p[6]=n("span",{class:"text-gray-400"},"Всего товаров:",-1)),n("span",an,m(e.value.total_products),1)]),n("div",ln,[p[7]||(p[7]=n("span",{class:"text-gray-400"},"Синхронизировано:",-1)),n("span",dn,m(e.value.synced_products),1)]),n("div",un,[p[8]||(p[8]=n("span",{class:"text-gray-400"},"Ошибок синхронизации:",-1)),n("span",cn,m(e.value.sync_errors),1)]),n("div",gn,[p[9]||(p[9]=n("span",{class:"text-gray-400"},"Ожидают обновления:",-1)),n("span",fn,m(e.value.pending_updates),1)])])):(g(),f("div",mn," Выберите маркетплейс для просмотра статистики "))]),n("div",pn,[p[11]||(p[11]=n("h3",{class:"text-lg font-medium text-white mb-4"},"Последние действия",-1)),a.value.length>0?(g(),f("div",hn,[(g(!0),f(L,null,z(a.value,k=>(g(),f("div",{key:k.id,class:mt(["border-l-4 pl-3 py-2",{"border-green-500":k.status==="success","border-red-500":k.status==="error","border-yellow-500":k.status==="warning"}])},[n("div",bn,[n("div",null,[n("p",vn,m(k.message),1),n("p",yn,m(j(k.marketplace))+" • "+m(E(k.created_at)),1)]),n("span",{class:mt(["text-xs px-2 py-1 rounded",{"bg-green-600 text-green-100":k.status==="success","bg-red-600 text-red-100":k.status==="error","bg-yellow-600 text-yellow-100":k.status==="warning"}])},m(k.status),3)])],2))),128))])):(g(),f("div",xn," Нет логов "))])]),u.value?(g(),f("div",_n,[n("div",wn,[n("div",kn,[n("h3",Cn," Маппинг атрибутов - "+m(j(b.value)),1),n("button",{onClick:I,class:"text-gray-400 hover:text-white"},p[12]||(p[12]=[n("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),n("div",En,[p[17]||(p[17]=n("h4",{class:"text-md font-medium text-white mb-3"},"Добавить маппинг",-1)),n("div",Sn,[n("div",null,[p[14]||(p[14]=n("label",{class:"block text-sm font-medium text-white mb-2"}," Наш атрибут ",-1)),X(n("select",{"onUpdate:modelValue":p[0]||(p[0]=k=>C.value.our_attr_id=k),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-3 py-2 text-white"},[p[13]||(p[13]=n("option",{value:""},"Выберите атрибут",-1)),(g(!0),f(L,null,z(s.value,k=>(g(),f("option",{key:k.id,value:k.id},m(k.name),9,Dn))),128))],512),[[ut,C.value.our_attr_id]])]),n("div",null,[p[16]||(p[16]=n("label",{class:"block text-sm font-medium text-white mb-2"}," Атрибут маркетплейса ",-1)),X(n("select",{"onUpdate:modelValue":p[1]||(p[1]=k=>C.value.marketplace_attr_name=k),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-3 py-2 text-white"},[p[15]||(p[15]=n("option",{value:""},"Выберите атрибут",-1)),(g(!0),f(L,null,z(d.value,k=>(g(),f("option",{key:k.id,value:k.id},m(k.name),9,Mn))),128))],512),[[ut,C.value.marketplace_attr_name]])]),n("div",Tn,[n("button",{onClick:F,disabled:!C.value.our_attr_id||!C.value.marketplace_attr_name,class:"w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors disabled:opacity-50"}," Добавить ",8,An)])])]),n("div",null,[p[20]||(p[20]=n("h4",{class:"text-md font-medium text-white mb-3"},"Существующие маппинги",-1)),l.value.length>0?(g(),f("div",In,[(g(!0),f(L,null,z(l.value,k=>{var B;return g(),f("div",{key:k.id,class:"bg-gray-700 rounded-lg p-3 flex justify-between items-center"},[n("div",null,[n("span",On,m(((B=k.attribute)==null?void 0:B.name)||"Неизвестный атрибут"),1),p[18]||(p[18]=n("span",{class:"text-gray-400 mx-2"},"→",-1)),n("span",Fn,m(Q(k.marketplace_attr_name)),1)]),n("button",{onClick:ct=>P(k.id),class:"text-red-400 hover:text-red-300"},p[19]||(p[19]=[n("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Pn)])}),128))])):(g(),f("div",jn," Нет настроенных маппингов "))])])])):$("",!0),c.value?(g(),f("div",Nn,[n("div",Vn,[p[24]||(p[24]=n("h3",{class:"text-xl font-semibold text-white mb-4"},"Результаты синхронизации",-1)),n("div",Rn,[n("div",Un,[p[21]||(p[21]=n("span",{class:"text-gray-400"},"Успешно синхронизировано:",-1)),n("span",Ln,m(y.value.success),1)]),n("div",zn,[p[22]||(p[22]=n("span",{class:"text-gray-400"},"Ошибок:",-1)),n("span",$n,m(y.value.failed),1)])]),y.value.errors&&y.value.errors.length>0?(g(),f("div",Bn,[p[23]||(p[23]=n("h4",{class:"text-md font-medium text-white mb-2"},"Ошибки:",-1)),n("div",Xn,[(g(!0),f(L,null,z(y.value.errors,(k,B)=>(g(),f("div",{key:B,class:"text-sm mb-2"},[n("span",Yn,m(k.product_name)+":",1),n("span",qn,m(k.error),1)]))),128))])])):$("",!0),n("div",Gn,[n("button",{onClick:p[2]||(p[2]=k=>c.value=!1),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors"}," Закрыть ")])])])):$("",!0)]))}},Wn=Qt(Hn,[["__scopeId","data-v-8fabe975"]]);/*!
  * vue-draggable-next v2.2.0
  * (c) 2023 Anish George
  * @license MIT
  *//**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Ye(o,t){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(o);t&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(o,a).enumerable})),r.push.apply(r,e)}return r}function xt(o){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ye(Object(r),!0).forEach(function(e){Qn(o,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):Ye(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function se(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?se=function(t){return typeof t}:se=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},se(o)}function Qn(o,t,r){return t in o?Object.defineProperty(o,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[t]=r,o}function wt(){return wt=Object.assign||function(o){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(o[e]=r[e])}return o},wt.apply(this,arguments)}function Kn(o,t){if(o==null)return{};var r={},e=Object.keys(o),a,l;for(l=0;l<e.length;l++)a=e[l],!(t.indexOf(a)>=0)&&(r[a]=o[a]);return r}function Zn(o,t){if(o==null)return{};var r=Kn(o,t),e,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(o);for(a=0;a<l.length;a++)e=l[a],!(t.indexOf(e)>=0)&&Object.prototype.propertyIsEnumerable.call(o,e)&&(r[e]=o[e])}return r}var Jn="1.14.0";function _t(o){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(o)}var kt=_t(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Kt=_t(/Edge/i),qe=_t(/firefox/i),Yt=_t(/safari/i)&&!_t(/chrome/i)&&!_t(/android/i),oo=_t(/iP(ad|od|hone)/i),tr=_t(/chrome/i)&&_t(/android/i),no={capture:!1,passive:!1};function U(o,t,r){o.addEventListener(t,r,!kt&&no)}function R(o,t,r){o.removeEventListener(t,r,!kt&&no)}function ue(o,t){if(t){if(t[0]===">"&&(t=t.substring(1)),o)try{if(o.matches)return o.matches(t);if(o.msMatchesSelector)return o.msMatchesSelector(t);if(o.webkitMatchesSelector)return o.webkitMatchesSelector(t)}catch{return!1}return!1}}function er(o){return o.host&&o!==document&&o.host.nodeType?o.host:o.parentNode}function vt(o,t,r,e){if(o){r=r||document;do{if(t!=null&&(t[0]===">"?o.parentNode===r&&ue(o,t):ue(o,t))||e&&o===r)return o;if(o===r)break}while(o=er(o))}return null}var Ge=/\s+/g;function st(o,t,r){if(o&&t)if(o.classList)o.classList[r?"add":"remove"](t);else{var e=(" "+o.className+" ").replace(Ge," ").replace(" "+t+" "," ");o.className=(e+(r?" "+t:"")).replace(Ge," ")}}function D(o,t,r){var e=o&&o.style;if(e){if(r===void 0)return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(o,""):o.currentStyle&&(r=o.currentStyle),t===void 0?r:r[t];!(t in e)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),e[t]=r+(typeof r=="string"?"":"px")}}function Vt(o,t){var r="";if(typeof o=="string")r=o;else do{var e=D(o,"transform");e&&e!=="none"&&(r=e+" "+r)}while(!t&&(o=o.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(r)}function ro(o,t,r){if(o){var e=o.getElementsByTagName(t),a=0,l=e.length;if(r)for(;a<l;a++)r(e[a],a);return e}return[]}function yt(){var o=document.scrollingElement;return o||document.documentElement}function Z(o,t,r,e,a){if(!(!o.getBoundingClientRect&&o!==window)){var l,s,d,u,c,b,i;if(o!==window&&o.parentNode&&o!==yt()?(l=o.getBoundingClientRect(),s=l.top,d=l.left,u=l.bottom,c=l.right,b=l.height,i=l.width):(s=0,d=0,u=window.innerHeight,c=window.innerWidth,b=window.innerHeight,i=window.innerWidth),(t||r)&&o!==window&&(a=a||o.parentNode,!kt))do if(a&&a.getBoundingClientRect&&(D(a,"transform")!=="none"||r&&D(a,"position")!=="static")){var y=a.getBoundingClientRect();s-=y.top+parseInt(D(a,"border-top-width")),d-=y.left+parseInt(D(a,"border-left-width")),u=s+l.height,c=d+l.width;break}while(a=a.parentNode);if(e&&o!==window){var C=Vt(a||o),A=C&&C.a,_=C&&C.d;C&&(s/=_,d/=A,i/=A,b/=_,u=s+b,c=d+i)}return{top:s,left:d,bottom:u,right:c,width:i,height:b}}}function He(o,t,r){for(var e=St(o,!0),a=Z(o)[t];e;){var l=Z(e)[r],s=void 0;if(r==="top"||r==="left"?s=a>=l:s=a<=l,!s)return e;if(e===yt())break;e=St(e,!1)}return!1}function Rt(o,t,r,e){for(var a=0,l=0,s=o.children;l<s.length;){if(s[l].style.display!=="none"&&s[l]!==M.ghost&&(e||s[l]!==M.dragged)&&vt(s[l],r.draggable,o,!1)){if(a===t)return s[l];a++}l++}return null}function Re(o,t){for(var r=o.lastElementChild;r&&(r===M.ghost||D(r,"display")==="none"||t&&!ue(r,t));)r=r.previousElementSibling;return r||null}function dt(o,t){var r=0;if(!o||!o.parentNode)return-1;for(;o=o.previousElementSibling;)o.nodeName.toUpperCase()!=="TEMPLATE"&&o!==M.clone&&(!t||ue(o,t))&&r++;return r}function We(o){var t=0,r=0,e=yt();if(o)do{var a=Vt(o),l=a.a,s=a.d;t+=o.scrollLeft*l,r+=o.scrollTop*s}while(o!==e&&(o=o.parentNode));return[t,r]}function or(o,t){for(var r in o)if(o.hasOwnProperty(r)){for(var e in t)if(t.hasOwnProperty(e)&&t[e]===o[r][e])return Number(r)}return-1}function St(o,t){if(!o||!o.getBoundingClientRect)return yt();var r=o,e=!1;do if(r.clientWidth<r.scrollWidth||r.clientHeight<r.scrollHeight){var a=D(r);if(r.clientWidth<r.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||r.clientHeight<r.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!r.getBoundingClientRect||r===document.body)return yt();if(e||t)return r;e=!0}}while(r=r.parentNode);return yt()}function nr(o,t){if(o&&t)for(var r in t)t.hasOwnProperty(r)&&(o[r]=t[r]);return o}function xe(o,t){return Math.round(o.top)===Math.round(t.top)&&Math.round(o.left)===Math.round(t.left)&&Math.round(o.height)===Math.round(t.height)&&Math.round(o.width)===Math.round(t.width)}var qt;function so(o,t){return function(){if(!qt){var r=arguments,e=this;r.length===1?o.call(e,r[0]):o.apply(e,r),qt=setTimeout(function(){qt=void 0},t)}}}function rr(){clearTimeout(qt),qt=void 0}function ao(o,t,r){o.scrollLeft+=t,o.scrollTop+=r}function io(o){var t=window.Polymer,r=window.jQuery||window.Zepto;return t&&t.dom?t.dom(o).cloneNode(!0):r?r(o).clone(!0)[0]:o.cloneNode(!0)}var it="Sortable"+new Date().getTime();function sr(){var o=[],t;return{captureAnimationState:function(){if(o=[],!!this.options.animation){var e=[].slice.call(this.el.children);e.forEach(function(a){if(!(D(a,"display")==="none"||a===M.ghost)){o.push({target:a,rect:Z(a)});var l=xt({},o[o.length-1].rect);if(a.thisAnimationDuration){var s=Vt(a,!0);s&&(l.top-=s.f,l.left-=s.e)}a.fromRect=l}})}},addAnimationState:function(e){o.push(e)},removeAnimationState:function(e){o.splice(or(o,{target:e}),1)},animateAll:function(e){var a=this;if(!this.options.animation){clearTimeout(t),typeof e=="function"&&e();return}var l=!1,s=0;o.forEach(function(d){var u=0,c=d.target,b=c.fromRect,i=Z(c),y=c.prevFromRect,C=c.prevToRect,A=d.rect,_=Vt(c,!0);_&&(i.top-=_.f,i.left-=_.e),c.toRect=i,c.thisAnimationDuration&&xe(y,i)&&!xe(b,i)&&(A.top-i.top)/(A.left-i.left)===(b.top-i.top)/(b.left-i.left)&&(u=ir(A,y,C,a.options)),xe(i,b)||(c.prevFromRect=b,c.prevToRect=i,u||(u=a.options.animation),a.animate(c,A,i,u)),u&&(l=!0,s=Math.max(s,u),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},u),c.thisAnimationDuration=u)}),clearTimeout(t),l?t=setTimeout(function(){typeof e=="function"&&e()},s):typeof e=="function"&&e(),o=[]},animate:function(e,a,l,s){if(s){D(e,"transition",""),D(e,"transform","");var d=Vt(this.el),u=d&&d.a,c=d&&d.d,b=(a.left-l.left)/(u||1),i=(a.top-l.top)/(c||1);e.animatingX=!!b,e.animatingY=!!i,D(e,"transform","translate3d("+b+"px,"+i+"px,0)"),this.forRepaintDummy=ar(e),D(e,"transition","transform "+s+"ms"+(this.options.easing?" "+this.options.easing:"")),D(e,"transform","translate3d(0,0,0)"),typeof e.animated=="number"&&clearTimeout(e.animated),e.animated=setTimeout(function(){D(e,"transition",""),D(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},s)}}}}function ar(o){return o.offsetWidth}function ir(o,t,r,e){return Math.sqrt(Math.pow(t.top-o.top,2)+Math.pow(t.left-o.left,2))/Math.sqrt(Math.pow(t.top-r.top,2)+Math.pow(t.left-r.left,2))*e.animation}var Ft=[],_e={initializeByDefault:!0},Zt={mount:function(t){for(var r in _e)_e.hasOwnProperty(r)&&!(r in t)&&(t[r]=_e[r]);Ft.forEach(function(e){if(e.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Ft.push(t)},pluginEvent:function(t,r,e){var a=this;this.eventCanceled=!1,e.cancel=function(){a.eventCanceled=!0};var l=t+"Global";Ft.forEach(function(s){r[s.pluginName]&&(r[s.pluginName][l]&&r[s.pluginName][l](xt({sortable:r},e)),r.options[s.pluginName]&&r[s.pluginName][t]&&r[s.pluginName][t](xt({sortable:r},e)))})},initializePlugins:function(t,r,e,a){Ft.forEach(function(d){var u=d.pluginName;if(!(!t.options[u]&&!d.initializeByDefault)){var c=new d(t,r,t.options);c.sortable=t,c.options=t.options,t[u]=c,wt(e,c.defaults)}});for(var l in t.options)if(t.options.hasOwnProperty(l)){var s=this.modifyOption(t,l,t.options[l]);typeof s<"u"&&(t.options[l]=s)}},getEventProperties:function(t,r){var e={};return Ft.forEach(function(a){typeof a.eventProperties=="function"&&wt(e,a.eventProperties.call(r[a.pluginName],t))}),e},modifyOption:function(t,r,e){var a;return Ft.forEach(function(l){t[l.pluginName]&&l.optionListeners&&typeof l.optionListeners[r]=="function"&&(a=l.optionListeners[r].call(t[l.pluginName],e))}),a}};function lr(o){var t=o.sortable,r=o.rootEl,e=o.name,a=o.targetEl,l=o.cloneEl,s=o.toEl,d=o.fromEl,u=o.oldIndex,c=o.newIndex,b=o.oldDraggableIndex,i=o.newDraggableIndex,y=o.originalEvent,C=o.putSortable,A=o.extraEventProperties;if(t=t||r&&r[it],!!t){var _,x=t.options,I="on"+e.charAt(0).toUpperCase()+e.substr(1);window.CustomEvent&&!kt&&!Kt?_=new CustomEvent(e,{bubbles:!0,cancelable:!0}):(_=document.createEvent("Event"),_.initEvent(e,!0,!0)),_.to=s||r,_.from=d||r,_.item=a||r,_.clone=l,_.oldIndex=u,_.newIndex=c,_.oldDraggableIndex=b,_.newDraggableIndex=i,_.originalEvent=y,_.pullMode=C?C.lastPutMode:void 0;var F=xt(xt({},A),Zt.getEventProperties(e,t));for(var P in F)_[P]=F[P];r&&r.dispatchEvent(_),x[I]&&x[I].call(t,_)}}var dr=["evt"],rt=function(t,r){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=e.evt,l=Zn(e,dr);Zt.pluginEvent.bind(M)(t,r,xt({dragEl:h,parentEl:G,ghostEl:O,rootEl:q,nextEl:It,lastDownEl:ae,cloneEl:H,cloneHidden:Et,dragStarted:$t,putSortable:J,activeSortable:M.active,originalEvent:a,oldIndex:Nt,oldDraggableIndex:Gt,newIndex:at,newDraggableIndex:Ct,hideGhostForTarget:go,unhideGhostForTarget:fo,cloneNowHidden:function(){Et=!0},cloneNowShown:function(){Et=!1},dispatchSortableEvent:function(d){nt({sortable:r,name:d,originalEvent:a})}},l))};function nt(o){lr(xt({putSortable:J,cloneEl:H,targetEl:h,rootEl:q,oldIndex:Nt,oldDraggableIndex:Gt,newIndex:at,newDraggableIndex:Ct},o))}var h,G,O,q,It,ae,H,Et,Nt,at,Gt,Ct,te,J,jt=!1,ce=!1,ge=[],Tt,gt,we,ke,Qe,Ke,$t,Pt,Ht,Wt=!1,ee=!1,ie,ot,Ce=[],Oe=!1,fe=[],he=typeof document<"u",oe=oo,Ze=Kt||kt?"cssFloat":"float",ur=he&&!tr&&!oo&&"draggable"in document.createElement("div"),lo=function(){if(he){if(kt)return!1;var o=document.createElement("x");return o.style.cssText="pointer-events:auto",o.style.pointerEvents==="auto"}}(),uo=function(t,r){var e=D(t),a=parseInt(e.width)-parseInt(e.paddingLeft)-parseInt(e.paddingRight)-parseInt(e.borderLeftWidth)-parseInt(e.borderRightWidth),l=Rt(t,0,r),s=Rt(t,1,r),d=l&&D(l),u=s&&D(s),c=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+Z(l).width,b=u&&parseInt(u.marginLeft)+parseInt(u.marginRight)+Z(s).width;if(e.display==="flex")return e.flexDirection==="column"||e.flexDirection==="column-reverse"?"vertical":"horizontal";if(e.display==="grid")return e.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(l&&d.float&&d.float!=="none"){var i=d.float==="left"?"left":"right";return s&&(u.clear==="both"||u.clear===i)?"vertical":"horizontal"}return l&&(d.display==="block"||d.display==="flex"||d.display==="table"||d.display==="grid"||c>=a&&e[Ze]==="none"||s&&e[Ze]==="none"&&c+b>a)?"vertical":"horizontal"},cr=function(t,r,e){var a=e?t.left:t.top,l=e?t.right:t.bottom,s=e?t.width:t.height,d=e?r.left:r.top,u=e?r.right:r.bottom,c=e?r.width:r.height;return a===d||l===u||a+s/2===d+c/2},gr=function(t,r){var e;return ge.some(function(a){var l=a[it].options.emptyInsertThreshold;if(!(!l||Re(a))){var s=Z(a),d=t>=s.left-l&&t<=s.right+l,u=r>=s.top-l&&r<=s.bottom+l;if(d&&u)return e=a}}),e},co=function(t){function r(l,s){return function(d,u,c,b){var i=d.options.group.name&&u.options.group.name&&d.options.group.name===u.options.group.name;if(l==null&&(s||i))return!0;if(l==null||l===!1)return!1;if(s&&l==="clone")return l;if(typeof l=="function")return r(l(d,u,c,b),s)(d,u,c,b);var y=(s?d:u).options.group.name;return l===!0||typeof l=="string"&&l===y||l.join&&l.indexOf(y)>-1}}var e={},a=t.group;(!a||se(a)!="object")&&(a={name:a}),e.name=a.name,e.checkPull=r(a.pull,!0),e.checkPut=r(a.put),e.revertClone=a.revertClone,t.group=e},go=function(){!lo&&O&&D(O,"display","none")},fo=function(){!lo&&O&&D(O,"display","")};he&&document.addEventListener("click",function(o){if(ce)return o.preventDefault(),o.stopPropagation&&o.stopPropagation(),o.stopImmediatePropagation&&o.stopImmediatePropagation(),ce=!1,!1},!0);var At=function(t){if(h){t=t.touches?t.touches[0]:t;var r=gr(t.clientX,t.clientY);if(r){var e={};for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.target=e.rootEl=r,e.preventDefault=void 0,e.stopPropagation=void 0,r[it]._onDragOver(e)}}},fr=function(t){h&&h.parentNode[it]._isOutsideThisEl(t.target)};function M(o,t){if(!(o&&o.nodeType&&o.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(o));this.el=o,this.options=t=wt({},t),o[it]=this;var r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(o.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return uo(o,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(s,d){s.setData("Text",d.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:M.supportPointer!==!1&&"PointerEvent"in window&&!Yt,emptyInsertThreshold:5};Zt.initializePlugins(this,o,r);for(var e in r)!(e in t)&&(t[e]=r[e]);co(t);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=t.forceFallback?!1:ur,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?U(o,"pointerdown",this._onTapStart):(U(o,"mousedown",this._onTapStart),U(o,"touchstart",this._onTapStart)),this.nativeDraggable&&(U(o,"dragover",this),U(o,"dragenter",this)),ge.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),wt(this,sr())}M.prototype={constructor:M,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Pt=null)},_getDirection:function(t,r){return typeof this.options.direction=="function"?this.options.direction.call(this,t,r,h):this.options.direction},_onTapStart:function(t){if(t.cancelable){var r=this,e=this.el,a=this.options,l=a.preventOnFilter,s=t.type,d=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,u=(d||t).target,c=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||u,b=a.filter;if(_r(e),!h&&!(/mousedown|pointerdown/.test(s)&&t.button!==0||a.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&Yt&&u&&u.tagName.toUpperCase()==="SELECT")&&(u=vt(u,a.draggable,e,!1),!(u&&u.animated)&&ae!==u)){if(Nt=dt(u),Gt=dt(u,a.draggable),typeof b=="function"){if(b.call(this,t,u,this)){nt({sortable:r,rootEl:c,name:"filter",targetEl:u,toEl:e,fromEl:e}),rt("filter",r,{evt:t}),l&&t.cancelable&&t.preventDefault();return}}else if(b&&(b=b.split(",").some(function(i){if(i=vt(c,i.trim(),e,!1),i)return nt({sortable:r,rootEl:i,name:"filter",targetEl:u,fromEl:e,toEl:e}),rt("filter",r,{evt:t}),!0}),b)){l&&t.cancelable&&t.preventDefault();return}a.handle&&!vt(c,a.handle,e,!1)||this._prepareDragStart(t,d,u)}}},_prepareDragStart:function(t,r,e){var a=this,l=a.el,s=a.options,d=l.ownerDocument,u;if(e&&!h&&e.parentNode===l){var c=Z(e);if(q=l,h=e,G=h.parentNode,It=h.nextSibling,ae=e,te=s.group,M.dragged=h,Tt={target:h,clientX:(r||t).clientX,clientY:(r||t).clientY},Qe=Tt.clientX-c.left,Ke=Tt.clientY-c.top,this._lastX=(r||t).clientX,this._lastY=(r||t).clientY,h.style["will-change"]="all",u=function(){if(rt("delayEnded",a,{evt:t}),M.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!qe&&a.nativeDraggable&&(h.draggable=!0),a._triggerDragStart(t,r),nt({sortable:a,name:"choose",originalEvent:t}),st(h,s.chosenClass,!0)},s.ignore.split(",").forEach(function(b){ro(h,b.trim(),Ee)}),U(d,"dragover",At),U(d,"mousemove",At),U(d,"touchmove",At),U(d,"mouseup",a._onDrop),U(d,"touchend",a._onDrop),U(d,"touchcancel",a._onDrop),qe&&this.nativeDraggable&&(this.options.touchStartThreshold=4,h.draggable=!0),rt("delayStart",this,{evt:t}),s.delay&&(!s.delayOnTouchOnly||r)&&(!this.nativeDraggable||!(Kt||kt))){if(M.eventCanceled){this._onDrop();return}U(d,"mouseup",a._disableDelayedDrag),U(d,"touchend",a._disableDelayedDrag),U(d,"touchcancel",a._disableDelayedDrag),U(d,"mousemove",a._delayedDragTouchMoveHandler),U(d,"touchmove",a._delayedDragTouchMoveHandler),s.supportPointer&&U(d,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(u,s.delay)}else u()}},_delayedDragTouchMoveHandler:function(t){var r=t.touches?t.touches[0]:t;Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){h&&Ee(h),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;R(t,"mouseup",this._disableDelayedDrag),R(t,"touchend",this._disableDelayedDrag),R(t,"touchcancel",this._disableDelayedDrag),R(t,"mousemove",this._delayedDragTouchMoveHandler),R(t,"touchmove",this._delayedDragTouchMoveHandler),R(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,r){r=r||t.pointerType=="touch"&&t,!this.nativeDraggable||r?this.options.supportPointer?U(document,"pointermove",this._onTouchMove):r?U(document,"touchmove",this._onTouchMove):U(document,"mousemove",this._onTouchMove):(U(h,"dragend",this),U(q,"dragstart",this._onDragStart));try{document.selection?le(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,r){if(jt=!1,q&&h){rt("dragStarted",this,{evt:r}),this.nativeDraggable&&U(document,"dragover",fr);var e=this.options;!t&&st(h,e.dragClass,!1),st(h,e.ghostClass,!0),M.active=this,t&&this._appendGhost(),nt({sortable:this,name:"start",originalEvent:r})}else this._nulling()},_emulateDragOver:function(){if(gt){this._lastX=gt.clientX,this._lastY=gt.clientY,go();for(var t=document.elementFromPoint(gt.clientX,gt.clientY),r=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(gt.clientX,gt.clientY),t!==r);)r=t;if(h.parentNode[it]._isOutsideThisEl(t),r)do{if(r[it]){var e=void 0;if(e=r[it]._onDragOver({clientX:gt.clientX,clientY:gt.clientY,target:t,rootEl:r}),e&&!this.options.dragoverBubble)break}t=r}while(r=r.parentNode);fo()}},_onTouchMove:function(t){if(Tt){var r=this.options,e=r.fallbackTolerance,a=r.fallbackOffset,l=t.touches?t.touches[0]:t,s=O&&Vt(O,!0),d=O&&s&&s.a,u=O&&s&&s.d,c=oe&&ot&&We(ot),b=(l.clientX-Tt.clientX+a.x)/(d||1)+(c?c[0]-Ce[0]:0)/(d||1),i=(l.clientY-Tt.clientY+a.y)/(u||1)+(c?c[1]-Ce[1]:0)/(u||1);if(!M.active&&!jt){if(e&&Math.max(Math.abs(l.clientX-this._lastX),Math.abs(l.clientY-this._lastY))<e)return;this._onDragStart(t,!0)}if(O){s?(s.e+=b-(we||0),s.f+=i-(ke||0)):s={a:1,b:0,c:0,d:1,e:b,f:i};var y="matrix(".concat(s.a,",").concat(s.b,",").concat(s.c,",").concat(s.d,",").concat(s.e,",").concat(s.f,")");D(O,"webkitTransform",y),D(O,"mozTransform",y),D(O,"msTransform",y),D(O,"transform",y),we=b,ke=i,gt=l}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!O){var t=this.options.fallbackOnBody?document.body:q,r=Z(h,!0,oe,!0,t),e=this.options;if(oe){for(ot=t;D(ot,"position")==="static"&&D(ot,"transform")==="none"&&ot!==document;)ot=ot.parentNode;ot!==document.body&&ot!==document.documentElement?(ot===document&&(ot=yt()),r.top+=ot.scrollTop,r.left+=ot.scrollLeft):ot=yt(),Ce=We(ot)}O=h.cloneNode(!0),st(O,e.ghostClass,!1),st(O,e.fallbackClass,!0),st(O,e.dragClass,!0),D(O,"transition",""),D(O,"transform",""),D(O,"box-sizing","border-box"),D(O,"margin",0),D(O,"top",r.top),D(O,"left",r.left),D(O,"width",r.width),D(O,"height",r.height),D(O,"opacity","0.8"),D(O,"position",oe?"absolute":"fixed"),D(O,"zIndex","100000"),D(O,"pointerEvents","none"),M.ghost=O,t.appendChild(O),D(O,"transform-origin",Qe/parseInt(O.style.width)*100+"% "+Ke/parseInt(O.style.height)*100+"%")}},_onDragStart:function(t,r){var e=this,a=t.dataTransfer,l=e.options;if(rt("dragStart",this,{evt:t}),M.eventCanceled){this._onDrop();return}rt("setupClone",this),M.eventCanceled||(H=io(h),H.draggable=!1,H.style["will-change"]="",this._hideClone(),st(H,this.options.chosenClass,!1),M.clone=H),e.cloneId=le(function(){rt("clone",e),!M.eventCanceled&&(e.options.removeCloneOnHide||q.insertBefore(H,h),e._hideClone(),nt({sortable:e,name:"clone"}))}),!r&&st(h,l.dragClass,!0),r?(ce=!0,e._loopId=setInterval(e._emulateDragOver,50)):(R(document,"mouseup",e._onDrop),R(document,"touchend",e._onDrop),R(document,"touchcancel",e._onDrop),a&&(a.effectAllowed="move",l.setData&&l.setData.call(e,a,h)),U(document,"drop",e),D(h,"transform","translateZ(0)")),jt=!0,e._dragStartId=le(e._dragStarted.bind(e,r,t)),U(document,"selectstart",e),$t=!0,Yt&&D(document.body,"user-select","none")},_onDragOver:function(t){var r=this.el,e=t.target,a,l,s,d=this.options,u=d.group,c=M.active,b=te===u,i=d.sort,y=J||c,C,A=this,_=!1;if(Oe)return;function x(Dt,be){rt(Dt,A,xt({evt:t,isOwner:b,axis:C?"vertical":"horizontal",revert:s,dragRect:a,targetRect:l,canSort:i,fromSortable:y,target:e,completed:F,onMove:function(Jt,ve){return ne(q,r,h,a,Jt,Z(Jt),t,ve)},changed:P},be))}function I(){x("dragOverAnimationCapture"),A.captureAnimationState(),A!==y&&y.captureAnimationState()}function F(Dt){return x("dragOverCompleted",{insertion:Dt}),Dt&&(b?c._hideClone():c._showClone(A),A!==y&&(st(h,J?J.options.ghostClass:c.options.ghostClass,!1),st(h,d.ghostClass,!0)),J!==A&&A!==M.active?J=A:A===M.active&&J&&(J=null),y===A&&(A._ignoreWhileAnimating=e),A.animateAll(function(){x("dragOverAnimationComplete"),A._ignoreWhileAnimating=null}),A!==y&&(y.animateAll(),y._ignoreWhileAnimating=null)),(e===h&&!h.animated||e===r&&!e.animated)&&(Pt=null),!d.dragoverBubble&&!t.rootEl&&e!==document&&(h.parentNode[it]._isOutsideThisEl(t.target),!Dt&&At(t)),!d.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),_=!0}function P(){at=dt(h),Ct=dt(h,d.draggable),nt({sortable:A,name:"change",toEl:r,newIndex:at,newDraggableIndex:Ct,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),e=vt(e,d.draggable,r,!0),x("dragOver"),M.eventCanceled)return _;if(h.contains(t.target)||e.animated&&e.animatingX&&e.animatingY||A._ignoreWhileAnimating===e)return F(!1);if(ce=!1,c&&!d.disabled&&(b?i||(s=G!==q):J===this||(this.lastPutMode=te.checkPull(this,c,h,t))&&u.checkPut(this,c,h,t))){if(C=this._getDirection(t,e)==="vertical",a=Z(h),x("dragOverValid"),M.eventCanceled)return _;if(s)return G=q,I(),this._hideClone(),x("revert"),M.eventCanceled||(It?q.insertBefore(h,It):q.appendChild(h)),F(!0);var w=Re(r,d.draggable);if(!w||br(t,C,this)&&!w.animated){if(w===h)return F(!1);if(w&&r===t.target&&(e=w),e&&(l=Z(e)),ne(q,r,h,a,e,l,t,!!e)!==!1)return I(),r.appendChild(h),G=r,P(),F(!0)}else if(w&&hr(t,C,this)){var E=Rt(r,0,d,!0);if(E===h)return F(!1);if(e=E,l=Z(e),ne(q,r,h,a,e,l,t,!1)!==!1)return I(),r.insertBefore(h,E),G=r,P(),F(!0)}else if(e.parentNode===r){l=Z(e);var j=0,Q,N=h.parentNode!==r,p=!cr(h.animated&&h.toRect||a,e.animated&&e.toRect||l,C),k=C?"top":"left",B=He(e,"top","top")||He(h,"top","top"),ct=B?B.scrollTop:void 0;Pt!==e&&(Q=l[k],Wt=!1,ee=!p&&d.invertSwap||N),j=vr(t,e,l,C,p?1:d.swapThreshold,d.invertedSwapThreshold==null?d.swapThreshold:d.invertedSwapThreshold,ee,Pt===e);var tt;if(j!==0){var lt=dt(h);do lt-=j,tt=G.children[lt];while(tt&&(D(tt,"display")==="none"||tt===O))}if(j===0||tt===e)return F(!1);Pt=e,Ht=j;var pt=e.nextElementSibling,ht=!1;ht=j===1;var Ot=ne(q,r,h,a,e,l,t,ht);if(Ot!==!1)return(Ot===1||Ot===-1)&&(ht=Ot===1),Oe=!0,setTimeout(pr,30),I(),ht&&!pt?r.appendChild(h):e.parentNode.insertBefore(h,ht?pt:e),B&&ao(B,0,ct-B.scrollTop),G=h.parentNode,Q!==void 0&&!ee&&(ie=Math.abs(Q-Z(e)[k])),P(),F(!0)}if(r.contains(h))return F(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){R(document,"mousemove",this._onTouchMove),R(document,"touchmove",this._onTouchMove),R(document,"pointermove",this._onTouchMove),R(document,"dragover",At),R(document,"mousemove",At),R(document,"touchmove",At)},_offUpEvents:function(){var t=this.el.ownerDocument;R(t,"mouseup",this._onDrop),R(t,"touchend",this._onDrop),R(t,"pointerup",this._onDrop),R(t,"touchcancel",this._onDrop),R(document,"selectstart",this)},_onDrop:function(t){var r=this.el,e=this.options;if(at=dt(h),Ct=dt(h,e.draggable),rt("drop",this,{evt:t}),G=h&&h.parentNode,at=dt(h),Ct=dt(h,e.draggable),M.eventCanceled){this._nulling();return}jt=!1,ee=!1,Wt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Fe(this.cloneId),Fe(this._dragStartId),this.nativeDraggable&&(R(document,"drop",this),R(r,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Yt&&D(document.body,"user-select",""),D(h,"transform",""),t&&($t&&(t.cancelable&&t.preventDefault(),!e.dropBubble&&t.stopPropagation()),O&&O.parentNode&&O.parentNode.removeChild(O),(q===G||J&&J.lastPutMode!=="clone")&&H&&H.parentNode&&H.parentNode.removeChild(H),h&&(this.nativeDraggable&&R(h,"dragend",this),Ee(h),h.style["will-change"]="",$t&&!jt&&st(h,J?J.options.ghostClass:this.options.ghostClass,!1),st(h,this.options.chosenClass,!1),nt({sortable:this,name:"unchoose",toEl:G,newIndex:null,newDraggableIndex:null,originalEvent:t}),q!==G?(at>=0&&(nt({rootEl:G,name:"add",toEl:G,fromEl:q,originalEvent:t}),nt({sortable:this,name:"remove",toEl:G,originalEvent:t}),nt({rootEl:G,name:"sort",toEl:G,fromEl:q,originalEvent:t}),nt({sortable:this,name:"sort",toEl:G,originalEvent:t})),J&&J.save()):at!==Nt&&at>=0&&(nt({sortable:this,name:"update",toEl:G,originalEvent:t}),nt({sortable:this,name:"sort",toEl:G,originalEvent:t})),M.active&&((at==null||at===-1)&&(at=Nt,Ct=Gt),nt({sortable:this,name:"end",toEl:G,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){rt("nulling",this),q=h=G=O=It=H=ae=Et=Tt=gt=$t=at=Ct=Nt=Gt=Pt=Ht=J=te=M.dragged=M.ghost=M.clone=M.active=null,fe.forEach(function(t){t.checked=!0}),fe.length=we=ke=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":h&&(this._onDragOver(t),mr(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],r,e=this.el.children,a=0,l=e.length,s=this.options;a<l;a++)r=e[a],vt(r,s.draggable,this.el,!1)&&t.push(r.getAttribute(s.dataIdAttr)||xr(r));return t},sort:function(t,r){var e={},a=this.el;this.toArray().forEach(function(l,s){var d=a.children[s];vt(d,this.options.draggable,a,!1)&&(e[l]=d)},this),r&&this.captureAnimationState(),t.forEach(function(l){e[l]&&(a.removeChild(e[l]),a.appendChild(e[l]))}),r&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,r){return vt(t,r||this.options.draggable,this.el,!1)},option:function(t,r){var e=this.options;if(r===void 0)return e[t];var a=Zt.modifyOption(this,t,r);typeof a<"u"?e[t]=a:e[t]=r,t==="group"&&co(e)},destroy:function(){rt("destroy",this);var t=this.el;t[it]=null,R(t,"mousedown",this._onTapStart),R(t,"touchstart",this._onTapStart),R(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(R(t,"dragover",this),R(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(r){r.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),ge.splice(ge.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!Et){if(rt("hideClone",this),M.eventCanceled)return;D(H,"display","none"),this.options.removeCloneOnHide&&H.parentNode&&H.parentNode.removeChild(H),Et=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(Et){if(rt("showClone",this),M.eventCanceled)return;h.parentNode==q&&!this.options.group.revertClone?q.insertBefore(H,h):It?q.insertBefore(H,It):q.appendChild(H),this.options.group.revertClone&&this.animate(h,H),D(H,"display",""),Et=!1}}};function mr(o){o.dataTransfer&&(o.dataTransfer.dropEffect="move"),o.cancelable&&o.preventDefault()}function ne(o,t,r,e,a,l,s,d){var u,c=o[it],b=c.options.onMove,i;return window.CustomEvent&&!kt&&!Kt?u=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(u=document.createEvent("Event"),u.initEvent("move",!0,!0)),u.to=t,u.from=o,u.dragged=r,u.draggedRect=e,u.related=a||t,u.relatedRect=l||Z(t),u.willInsertAfter=d,u.originalEvent=s,o.dispatchEvent(u),b&&(i=b.call(c,u,s)),i}function Ee(o){o.draggable=!1}function pr(){Oe=!1}function hr(o,t,r){var e=Z(Rt(r.el,0,r.options,!0)),a=10;return t?o.clientX<e.left-a||o.clientY<e.top&&o.clientX<e.right:o.clientY<e.top-a||o.clientY<e.bottom&&o.clientX<e.left}function br(o,t,r){var e=Z(Re(r.el,r.options.draggable)),a=10;return t?o.clientX>e.right+a||o.clientX<=e.right&&o.clientY>e.bottom&&o.clientX>=e.left:o.clientX>e.right&&o.clientY>e.top||o.clientX<=e.right&&o.clientY>e.bottom+a}function vr(o,t,r,e,a,l,s,d){var u=e?o.clientY:o.clientX,c=e?r.height:r.width,b=e?r.top:r.left,i=e?r.bottom:r.right,y=!1;if(!s){if(d&&ie<c*a){if(!Wt&&(Ht===1?u>b+c*l/2:u<i-c*l/2)&&(Wt=!0),Wt)y=!0;else if(Ht===1?u<b+ie:u>i-ie)return-Ht}else if(u>b+c*(1-a)/2&&u<i-c*(1-a)/2)return yr(t)}return y=y||s,y&&(u<b+c*l/2||u>i-c*l/2)?u>b+c/2?1:-1:0}function yr(o){return dt(h)<dt(o)?1:-1}function xr(o){for(var t=o.tagName+o.className+o.src+o.href+o.textContent,r=t.length,e=0;r--;)e+=t.charCodeAt(r);return e.toString(36)}function _r(o){fe.length=0;for(var t=o.getElementsByTagName("input"),r=t.length;r--;){var e=t[r];e.checked&&fe.push(e)}}function le(o){return setTimeout(o,0)}function Fe(o){return clearTimeout(o)}he&&U(document,"touchmove",function(o){(M.active||jt)&&o.cancelable&&o.preventDefault()});M.utils={on:U,off:R,css:D,find:ro,is:function(t,r){return!!vt(t,r,t,!1)},extend:nr,throttle:so,closest:vt,toggleClass:st,clone:io,index:dt,nextTick:le,cancelNextTick:Fe,detectDirection:uo,getChild:Rt};M.get=function(o){return o[it]};M.mount=function(){for(var o=arguments.length,t=new Array(o),r=0;r<o;r++)t[r]=arguments[r];t[0].constructor===Array&&(t=t[0]),t.forEach(function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(M.utils=xt(xt({},M.utils),e.utils)),Zt.mount(e)})};M.create=function(o,t){return new M(o,t)};M.version=Jn;var W=[],Bt,Pe,je=!1,Se,De,me,Xt;function wr(){function o(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return o.prototype={dragStarted:function(r){var e=r.originalEvent;this.sortable.nativeDraggable?U(document,"dragover",this._handleAutoScroll):this.options.supportPointer?U(document,"pointermove",this._handleFallbackAutoScroll):e.touches?U(document,"touchmove",this._handleFallbackAutoScroll):U(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(r){var e=r.originalEvent;!this.options.dragOverBubble&&!e.rootEl&&this._handleAutoScroll(e)},drop:function(){this.sortable.nativeDraggable?R(document,"dragover",this._handleAutoScroll):(R(document,"pointermove",this._handleFallbackAutoScroll),R(document,"touchmove",this._handleFallbackAutoScroll),R(document,"mousemove",this._handleFallbackAutoScroll)),Je(),de(),rr()},nulling:function(){me=Pe=Bt=je=Xt=Se=De=null,W.length=0},_handleFallbackAutoScroll:function(r){this._handleAutoScroll(r,!0)},_handleAutoScroll:function(r,e){var a=this,l=(r.touches?r.touches[0]:r).clientX,s=(r.touches?r.touches[0]:r).clientY,d=document.elementFromPoint(l,s);if(me=r,e||this.options.forceAutoScrollFallback||Kt||kt||Yt){Me(r,this.options,d,e);var u=St(d,!0);je&&(!Xt||l!==Se||s!==De)&&(Xt&&Je(),Xt=setInterval(function(){var c=St(document.elementFromPoint(l,s),!0);c!==u&&(u=c,de()),Me(r,a.options,c,e)},10),Se=l,De=s)}else{if(!this.options.bubbleScroll||St(d,!0)===yt()){de();return}Me(r,this.options,St(d,!1),!1)}}},wt(o,{pluginName:"scroll",initializeByDefault:!0})}function de(){W.forEach(function(o){clearInterval(o.pid)}),W=[]}function Je(){clearInterval(Xt)}var Me=so(function(o,t,r,e){if(t.scroll){var a=(o.touches?o.touches[0]:o).clientX,l=(o.touches?o.touches[0]:o).clientY,s=t.scrollSensitivity,d=t.scrollSpeed,u=yt(),c=!1,b;Pe!==r&&(Pe=r,de(),Bt=t.scroll,b=t.scrollFn,Bt===!0&&(Bt=St(r,!0)));var i=0,y=Bt;do{var C=y,A=Z(C),_=A.top,x=A.bottom,I=A.left,F=A.right,P=A.width,w=A.height,E=void 0,j=void 0,Q=C.scrollWidth,N=C.scrollHeight,p=D(C),k=C.scrollLeft,B=C.scrollTop;C===u?(E=P<Q&&(p.overflowX==="auto"||p.overflowX==="scroll"||p.overflowX==="visible"),j=w<N&&(p.overflowY==="auto"||p.overflowY==="scroll"||p.overflowY==="visible")):(E=P<Q&&(p.overflowX==="auto"||p.overflowX==="scroll"),j=w<N&&(p.overflowY==="auto"||p.overflowY==="scroll"));var ct=E&&(Math.abs(F-a)<=s&&k+P<Q)-(Math.abs(I-a)<=s&&!!k),tt=j&&(Math.abs(x-l)<=s&&B+w<N)-(Math.abs(_-l)<=s&&!!B);if(!W[i])for(var lt=0;lt<=i;lt++)W[lt]||(W[lt]={});(W[i].vx!=ct||W[i].vy!=tt||W[i].el!==C)&&(W[i].el=C,W[i].vx=ct,W[i].vy=tt,clearInterval(W[i].pid),(ct!=0||tt!=0)&&(c=!0,W[i].pid=setInterval((function(){e&&this.layer===0&&M.active._onTouchMove(me);var pt=W[this.layer].vy?W[this.layer].vy*d:0,ht=W[this.layer].vx?W[this.layer].vx*d:0;typeof b=="function"&&b.call(M.dragged.parentNode[it],ht,pt,o,me,W[this.layer].el)!=="continue"||ao(W[this.layer].el,ht,pt)}).bind({layer:i}),24))),i++}while(t.bubbleScroll&&y!==u&&(y=St(y,!1)));je=c}},30),mo=function(t){var r=t.originalEvent,e=t.putSortable,a=t.dragEl,l=t.activeSortable,s=t.dispatchSortableEvent,d=t.hideGhostForTarget,u=t.unhideGhostForTarget;if(r){var c=e||l;d();var b=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:r,i=document.elementFromPoint(b.clientX,b.clientY);u(),c&&!c.el.contains(i)&&(s("spill"),this.onSpill({dragEl:a,putSortable:e}))}};function Ue(){}Ue.prototype={startIndex:null,dragStart:function(t){var r=t.oldDraggableIndex;this.startIndex=r},onSpill:function(t){var r=t.dragEl,e=t.putSortable;this.sortable.captureAnimationState(),e&&e.captureAnimationState();var a=Rt(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(r,a):this.sortable.el.appendChild(r),this.sortable.animateAll(),e&&e.animateAll()},drop:mo};wt(Ue,{pluginName:"revertOnSpill"});function Le(){}Le.prototype={onSpill:function(t){var r=t.dragEl,e=t.putSortable,a=e||this.sortable;a.captureAnimationState(),r.parentNode&&r.parentNode.removeChild(r),a.animateAll()},drop:mo};wt(Le,{pluginName:"removeOnSpill"});M.mount(new wr);M.mount(Le,Ue);function kr(){return typeof window<"u"?window.console:global.console}const Cr=kr();function Er(o){const t=Object.create(null);return function(e){return t[e]||(t[e]=o(e))}}const Sr=/-(\w)/g,to=Er(o=>o.replace(Sr,(t,r)=>r?r.toUpperCase():""));function Te(o){o.parentElement!==null&&o.parentElement.removeChild(o)}function eo(o,t,r){const e=r===0?o.children[0]:o.children[r-1].nextSibling;o.insertBefore(t,e)}function Dr(o,t){return Object.values(o).indexOf(t)}function Mr(o,t,r,e){if(!o)return[];const a=Object.values(o),l=t.length-e;return[...t].map((d,u)=>u>=l?a.length:a.indexOf(d))}function po(o,t){this.$nextTick(()=>this.$emit(o.toLowerCase(),t))}function Tr(o){return t=>{this.realList!==null&&this["onDrag"+o](t),po.call(this,o,t)}}function Ar(o){return["transition-group","TransitionGroup"].includes(o)}function Ir(o){if(!o||o.length!==1)return!1;const[{type:t}]=o;return t?Ar(t.name):!1}function Or(o,t){return t?{...t.props,...t.attrs}:o}const Ne=["Start","Add","Remove","Update","End"],Ve=["Choose","Unchoose","Sort","Filter","Clone"],Fr=["Move",...Ne,...Ve].map(o=>"on"+o);let Ae=null;const Pr={options:Object,list:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:o=>o},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null},component:{type:String,default:null},modelValue:{type:Array,required:!1,default:null}},jr=jo({name:"VueDraggableNext",inheritAttrs:!1,emits:["update:modelValue","move","change",...Ne.map(o=>o.toLowerCase()),...Ve.map(o=>o.toLowerCase())],props:Pr,data(){return{transitionMode:!1,noneFunctionalComponentMode:!1,headerOffset:0,footerOffset:0,_sortable:{},visibleIndexes:[],context:{}}},render(){const o=this.$slots.default?this.$slots.default():null,t=Or(this.$attrs,this.componentData);return o?(this.transitionMode=Ir(o),$e(this.getTag(),t,o)):$e(this.getTag(),t,[])},created(){this.list!==null&&this.modelValue!==null&&Cr.error("list props are mutually exclusive! Please set one.")},mounted(){const o={};Ne.forEach(a=>{o["on"+a]=Tr.call(this,a)}),Ve.forEach(a=>{o["on"+a]=po.bind(this,a)});const t=Object.keys(this.$attrs).reduce((a,l)=>(a[to(l)]=this.$attrs[l],a),{}),r=Object.assign({},t,o,{onMove:(a,l)=>this.onDragMove(a,l)});!("draggable"in r)&&(r.draggable=">*");const e=this.$el.nodeType===1?this.$el:this.$el.parentElement;this._sortable=new M(e,r),e.__draggable_component__=this,this.computeIndexes()},beforeUnmount(){try{this._sortable!==void 0&&this._sortable.destroy()}catch{}},computed:{realList(){return this.list?this.list:this.modelValue}},watch:{$attrs:{handler(o){this.updateOptions(o)},deep:!0},realList(){this.computeIndexes()}},methods:{getTag(){return this.component?re(this.component):this.tag},updateOptions(o){for(var t in o){const r=to(t);Fr.indexOf(r)===-1&&this._sortable.option(r,o[t])}},getChildrenNodes(){return this.$el.children},computeIndexes(){this.$nextTick(()=>{this.visibleIndexes=Mr(this.getChildrenNodes(),this.$el.children,this.transitionMode,this.footerOffset)})},getUnderlyingVm(o){const t=Dr(this.getChildrenNodes()||[],o);if(t===-1)return null;const r=this.realList[t];return{index:t,element:r}},emitChanges(o){this.$nextTick(()=>{this.$emit("change",o)})},alterList(o){if(this.list){o(this.list);return}const t=[...this.modelValue];o(t),this.$emit("update:modelValue",t)},spliceList(){const o=t=>t.splice(...arguments);this.alterList(o)},updatePosition(o,t){const r=e=>e.splice(t,0,e.splice(o,1)[0]);this.alterList(r)},getVmIndex(o){const t=this.visibleIndexes,r=t.length;return o>r-1?r:t[o]},getComponent(){return this.$slots.default?this.$slots.default()[0].componentInstance:null},resetTransitionData(o){if(!this.noTransitionOnDrag||!this.transitionMode)return;var t=this.getChildrenNodes();t[o].data=null;const r=this.getComponent();r.children=[],r.kept=void 0},onDragStart(o){this.computeIndexes(),this.context=this.getUnderlyingVm(o.item),this.context&&(o.item._underlying_vm_=this.clone(this.context.element),Ae=o.item)},onDragAdd(o){const t=o.item._underlying_vm_;if(t===void 0)return;Te(o.item);const r=this.getVmIndex(o.newIndex);this.spliceList(r,0,t),this.computeIndexes();const e={element:t,newIndex:r};this.emitChanges({added:e})},onDragRemove(o){if(eo(this.$el,o.item,o.oldIndex),o.pullMode==="clone"){Te(o.clone);return}if(!this.context)return;const t=this.context.index;this.spliceList(t,1);const r={element:this.context.element,oldIndex:t};this.resetTransitionData(t),this.emitChanges({removed:r})},onDragUpdate(o){Te(o.item),eo(o.from,o.item,o.oldIndex);const t=this.context.index,r=this.getVmIndex(o.newIndex);this.updatePosition(t,r);const e={element:this.context.element,oldIndex:t,newIndex:r};this.emitChanges({moved:e})},updateProperty(o,t){o.hasOwnProperty(t)&&(o[t]+=this.headerOffset)},onDragMove(o,t){const r=this.move;if(!r||!this.realList)return!0;const e=this.getRelatedContextFromMoveEvent(o),a=this.context,l=this.computeFutureIndex(e,o);Object.assign(a,{futureIndex:l});const s=Object.assign({},o,{relatedContext:e,draggedContext:a});return r(s,t)},onDragEnd(){this.computeIndexes(),Ae=null},getTrargetedComponent(o){return o.__draggable_component__},getRelatedContextFromMoveEvent({to:o,related:t}){const r=this.getTrargetedComponent(o);if(!r)return{component:r};const e=r.realList,a={list:e,component:r};if(o!==t&&e&&r.getUnderlyingVm){const l=r.getUnderlyingVm(t);if(l)return Object.assign(l,a)}return a},computeFutureIndex(o,t){const r=[...t.to.children].filter(s=>s.style.display!=="none");if(r.length===0)return 0;const e=r.indexOf(t.related),a=o.component.getVmIndex(e);return r.indexOf(Ae)!==-1||!t.willInsertAfter?a:a+1}}});const Nr={class:"product-image-manager"},Vr={class:"upload-section mb-6"},Rr={class:"upload-area"},Ur={key:0,class:"mt-4 space-y-2"},Lr={class:"flex justify-between items-center mb-1"},zr={class:"text-sm text-white truncate"},$r={class:"text-xs text-gray-400"},Br={class:"w-full bg-gray-600 rounded-full h-2"},Xr={key:0,class:"images-grid"},Yr=["src","alt"],qr={key:0,class:"absolute top-2 left-2"},Gr={class:"absolute inset-0 bg-black bg-opacity-75 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center space-x-2"},Hr=["onClick"],Wr=["onClick"],Qr={class:"absolute bottom-2 right-2 bg-gray-900 bg-opacity-75 text-white text-xs px-2 py-1 rounded"},Kr={key:1,class:"text-center py-8"},Zr={__name:"ProductImageManager",props:{productId:{type:Number,required:!1,default:null},initialImages:{type:Array,default:()=>[]}},emits:["imagesUpdated"],setup(o,{emit:t}){const r=jr,e=o,a=t,l=S([...e.initialImages]),s=S([]),d=S(!1);No(()=>e.initialImages,_=>{l.value=[..._]});const u=_=>{const x=Array.from(_.target.files);b(x)},c=_=>{const I=Array.from(_.dataTransfer.files).filter(F=>F.type.startsWith("image/"));I.length>0&&b(I)},b=async _=>{d.value=!0;for(const x of _){if(x.size>5*1024*1024){alert(`Файл ${x.name} слишком большой. Максимальный размер: 5MB`);continue}const I={name:x.name,progress:0};s.value.push(I);try{const F=new FormData;F.append("image",x),F.append("type","product"),e.productId&&F.append("product_id",e.productId);const P=await T.post("/admin/images/upload",F,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:w=>{I.progress=Math.round(w.loaded*100/w.total)}});l.value.push(P.data.image),s.value=s.value.filter(w=>w!==I),a("imagesUpdated",l.value)}catch(F){console.error("Ошибка загрузки:",F),alert(`Ошибка загрузки файла ${x.name}`),s.value=s.value.filter(P=>P!==I)}}d.value=!1},i=async _=>{if(confirm("Удалить это изображение?"))try{await T.delete(`/admin/images/${_.id}`),l.value=l.value.filter(x=>x.id!==_.id),a("imagesUpdated",l.value)}catch(x){console.error("Ошибка удаления:",x),alert("Ошибка удаления изображения")}},y=async _=>{try{await T.post("/admin/images/set-main",{image_id:_.id}),l.value.forEach(x=>{x.is_main=x.id===_.id}),a("imagesUpdated",l.value)}catch(x){console.error("Ошибка установки главного изображения:",x),alert("Ошибка установки главного изображения")}},C=async()=>{const _=l.value.map((x,I)=>({id:x.id,sort_order:I}));try{await T.post("/admin/images/reorder",{images:_}),a("imagesUpdated",l.value)}catch(x){console.error("Ошибка изменения порядка:",x),alert("Ошибка изменения порядка изображений")}},A=_=>{_.target.src="/placeholder-image.png"};return(_,x)=>(g(),f("div",Nr,[n("div",Vr,[x[5]||(x[5]=n("h3",{class:"text-lg font-semibold text-white mb-3"},"Изображения товара",-1)),n("div",Rr,[n("input",{ref:"fileInput",type:"file",multiple:"",accept:"image/*",class:"hidden",onChange:u},null,544),n("div",{onClick:x[0]||(x[0]=I=>_.$refs.fileInput.click()),onDrop:ft(c,["prevent"]),onDragover:x[1]||(x[1]=ft(()=>{},["prevent"])),onDragenter:x[2]||(x[2]=ft(()=>{},["prevent"])),class:"border-2 border-dashed border-gray-600 rounded-lg p-8 text-center cursor-pointer hover:border-blue-500 transition-colors"},x[4]||(x[4]=[n("svg",{class:"w-12 h-12 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),n("p",{class:"text-gray-300 mb-2"},"Перетащите изображения сюда или кликните для выбора",-1),n("p",{class:"text-gray-500 text-sm"},"Поддерживаются: JPG, PNG, GIF, WebP (макс. 5MB)",-1)]),32)]),s.value.length>0?(g(),f("div",Ur,[(g(!0),f(L,null,z(s.value,(I,F)=>(g(),f("div",{key:F,class:"bg-gray-700 rounded p-3"},[n("div",Lr,[n("span",zr,m(I.name),1),n("span",$r,m(I.progress)+"%",1)]),n("div",Br,[n("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:Vo({width:I.progress+"%"})},null,4)])]))),128))])):$("",!0)]),l.value.length>0?(g(),f("div",Xr,[x[9]||(x[9]=n("h4",{class:"text-md font-medium text-white mb-3"}," Текущие изображения (перетащите для изменения порядка) ",-1)),Ut(Ro(r),{modelValue:l.value,"onUpdate:modelValue":x[3]||(x[3]=I=>l.value=I),onEnd:C,"item-key":"id",class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4","ghost-class":"opacity-50",animation:"200"},{item:Ie(({element:I})=>[n("div",{class:mt(["image-item relative group bg-gray-800 rounded-lg overflow-hidden cursor-move",{"ring-2 ring-green-500":I.is_main}])},[n("img",{src:I.url,alt:I.filename,class:"w-full h-32 object-cover",onError:A},null,40,Yr),I.is_main?(g(),f("div",qr,x[6]||(x[6]=[n("span",{class:"bg-green-600 text-white text-xs px-2 py-1 rounded"}," Главное ",-1)]))):$("",!0),n("div",Gr,[I.is_main?$("",!0):(g(),f("button",{key:0,onClick:F=>y(I),class:"bg-green-600 hover:bg-green-700 text-white p-2 rounded transition-colors",title:"Сделать главным"},x[7]||(x[7]=[n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]),8,Hr)),n("button",{onClick:F=>i(I),class:"bg-red-600 hover:bg-red-700 text-white p-2 rounded transition-colors",title:"Удалить"},x[8]||(x[8]=[n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Wr)]),n("div",Qr," #"+m(l.value.indexOf(I)+1),1)],2)]),_:1},8,["modelValue"])])):(g(),f("div",Kr,x[10]||(x[10]=[n("p",{class:"text-gray-400"},"Нет загруженных изображений",-1)])))]))}},Jr=Qt(Zr,[["__scopeId","data-v-ac2ed4c0"]]);const ts={name:"MarketplaceAdmin",setup(){const o=S([]),t=S([]),r=S([]),e=S(""),a=S(!1),l=S(null),s=Lt({}),d=S(!1),u=S(!1),c=S({current_page:1,last_page:1}),b=S({marketplace:"",our_attr_id:"",marketplace_attr_name:""}),i=async()=>{try{const E=await T.get("/admin/marketplace-maps");o.value=E.data.marketplaces||[]}catch(E){console.error("Ошибка загрузки маркетплейсов:",E)}},y=async(E=1)=>{try{const j={page:E};e.value&&(j.marketplace=e.value);const Q=await T.get("/admin/marketplace-maps",{params:j});t.value=Q.data.data||[],c.value={current_page:Q.data.current_page,last_page:Q.data.last_page}}catch(j){console.error("Ошибка загрузки маппингов:",j)}},C=async()=>{try{const E=await T.get("/admin/attributes");r.value=E.data}catch(E){console.error("Ошибка загрузки атрибутов:",E)}},A=async E=>{s[E]=!0;try{await T.post("/admin/marketplace/sync",{marketplace:E}),alert(`${E} синхронизирован!`),await i()}catch(j){console.error("Ошибка синхронизации:",j),alert("Ошибка синхронизации")}finally{s[E]=!1}},_=async()=>{d.value=!0;try{await T.post("/admin/marketplace/sync"),alert("Все маркетплейсы синхронизированы!"),await i()}catch(E){console.error("Ошибка синхронизации:",E),alert("Ошибка синхронизации")}finally{d.value=!1}},x=async()=>{u.value=!0;try{l.value?await T.put(`/admin/marketplace-maps/${l.value.id}`,b.value):await T.post("/admin/marketplace-maps",b.value),alert("Маппинг сохранен!"),P(),await y()}catch(E){console.error("Ошибка сохранения:",E),alert("Ошибка сохранения маппинга")}finally{u.value=!1}},I=E=>{l.value=E,b.value={marketplace:E.marketplace,our_attr_id:E.our_attr_id,marketplace_attr_name:E.marketplace_attr_name},a.value=!0},F=async E=>{var j;if(confirm(`Удалить маппинг для ${(j=E.attribute)==null?void 0:j.name}?`))try{await T.delete(`/admin/marketplace-maps/${E.id}`),alert("Маппинг удален!"),await y()}catch(Q){console.error("Ошибка удаления:",Q),alert("Ошибка удаления маппинга")}},P=()=>{a.value=!1,l.value=null,b.value={marketplace:"",our_attr_id:"",marketplace_attr_name:""}},w=E=>E?new Date(E).toLocaleString("ru-RU"):"Никогда";return pe(()=>{i(),y(),C()}),{marketplaces:o,maps:t,attributes:r,filterMarketplace:e,showMapModal:a,editingMap:l,syncing:s,syncingAll:d,savingMap:u,pagination:c,mapForm:b,loadMaps:y,syncMarketplace:A,syncAll:_,saveMap:x,editMap:I,deleteMap:F,closeMapModal:P,formatDate:w}}},es={class:"marketplace-admin p-6"},os={class:"bg-gray-800 rounded-lg p-6 mb-6"},ns={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6"},rs={class:"font-semibold text-white mb-3"},ss={class:"space-y-2 text-sm"},as={class:"flex justify-between"},is={class:"flex justify-between"},ls={key:0,class:"flex justify-between"},ds={class:"text-white"},us={class:"flex justify-between"},cs={class:"text-white"},gs=["onClick","disabled"],fs=["disabled"],ms={class:"bg-gray-800 rounded-lg p-6"},ps={class:"flex justify-between items-center mb-6"},hs={class:"mb-4"},bs={class:"overflow-x-auto"},vs={class:"w-full"},ys={class:"py-3 px-4 text-white capitalize"},xs={class:"py-3 px-4 text-white"},_s={class:"py-3 px-4 text-white"},ws={class:"py-3 px-4"},ks=["onClick"],Cs=["onClick"],Es={key:0,class:"flex justify-center mt-4 space-x-2"},Ss=["onClick"],Ds={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},Ms={class:"bg-gray-800 rounded-lg p-6 w-full max-w-md"},Ts={class:"text-xl font-bold text-white mb-4"},As=["disabled"],Is=["value"],Os={class:"flex justify-end gap-3 pt-4"},Fs=["disabled"];function Ps(o,t,r,e,a,l){return g(),f("div",es,[n("div",os,[t[13]||(t[13]=n("h2",{class:"text-2xl font-bold text-white mb-6"},"Статус маркетплейсов",-1)),n("div",ns,[(g(!0),f(L,null,z(e.marketplaces,s=>(g(),f("div",{key:s.id,class:"bg-gray-700 rounded-lg p-4"},[n("h3",rs,m(s.name),1),n("div",ss,[n("div",as,[t[9]||(t[9]=n("span",{class:"text-gray-400"},"Статус:",-1)),n("span",{class:mt(s.enabled?"text-green-400":"text-red-400")},m(s.enabled?"Активен":"Не настроен"),3)]),n("div",is,[t[10]||(t[10]=n("span",{class:"text-gray-400"},"Настроен:",-1)),n("span",{class:mt(s.configured?"text-green-400":"text-yellow-400")},m(s.configured?"Да":"Нет"),3)]),s.last_sync?(g(),f("div",ls,[t[11]||(t[11]=n("span",{class:"text-gray-400"},"Синхронизация:",-1)),n("span",ds,m(e.formatDate(s.last_sync)),1)])):$("",!0),n("div",us,[t[12]||(t[12]=n("span",{class:"text-gray-400"},"Товаров:",-1)),n("span",cs,m(s.products_count||0),1)])]),s.enabled&&s.configured?(g(),f("button",{key:0,onClick:d=>e.syncMarketplace(s.id),disabled:e.syncing[s.id],class:"mt-4 w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all"},m(e.syncing[s.id]?"Синхронизация...":"Синхронизировать"),9,gs)):$("",!0)]))),128))]),n("button",{onClick:t[0]||(t[0]=(...s)=>e.syncAll&&e.syncAll(...s)),disabled:e.syncingAll,class:"bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all"},m(e.syncingAll?"Синхронизация всех...":"Синхронизировать все"),9,fs)]),n("div",ms,[n("div",ps,[t[14]||(t[14]=n("h2",{class:"text-2xl font-bold text-white"},"Маппинг атрибутов",-1)),n("button",{onClick:t[1]||(t[1]=s=>e.showMapModal=!0),class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-all"}," + Добавить маппинг ")]),n("div",hs,[X(n("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>e.filterMarketplace=s),onChange:t[3]||(t[3]=(...s)=>e.loadMaps&&e.loadMaps(...s)),class:"bg-gray-700 text-white px-4 py-2 rounded border border-gray-600 focus:border-blue-500 focus:outline-none"},t[15]||(t[15]=[Be('<option value="" data-v-58f42a03>Все маркетплейсы</option><option value="wildberries" data-v-58f42a03>Wildberries</option><option value="ozon" data-v-58f42a03>Ozon</option><option value="yandex_market" data-v-58f42a03>Яндекс.Маркет</option><option value="flowwow" data-v-58f42a03>Flowwow</option>',5)]),544),[[ut,e.filterMarketplace]])]),n("div",bs,[n("table",vs,[t[16]||(t[16]=n("thead",null,[n("tr",{class:"border-b border-gray-700"},[n("th",{class:"text-left py-3 px-4 text-gray-400"},"Маркетплейс"),n("th",{class:"text-left py-3 px-4 text-gray-400"},"Наш атрибут"),n("th",{class:"text-left py-3 px-4 text-gray-400"},"Атрибут маркетплейса"),n("th",{class:"text-left py-3 px-4 text-gray-400"},"Действия")])],-1)),n("tbody",null,[(g(!0),f(L,null,z(e.maps,s=>{var d;return g(),f("tr",{key:s.id,class:"border-b border-gray-700 hover:bg-gray-700/50 transition-colors"},[n("td",ys,m(s.marketplace.replace("_"," ")),1),n("td",xs,m(((d=s.attribute)==null?void 0:d.name)||"Неизвестный атрибут"),1),n("td",_s,m(s.marketplace_attr_name),1),n("td",ws,[n("button",{onClick:u=>e.editMap(s),class:"text-blue-400 hover:text-blue-300 mr-3"}," Изменить ",8,ks),n("button",{onClick:u=>e.deleteMap(s),class:"text-red-400 hover:text-red-300"}," Удалить ",8,Cs)])])}),128))])]),e.pagination.last_page>1?(g(),f("div",Es,[(g(!0),f(L,null,z(e.pagination.last_page,s=>(g(),f("button",{key:s,onClick:d=>e.loadMaps(s),class:mt(["px-3 py-1 rounded",e.pagination.current_page===s?"bg-blue-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},m(s),11,Ss))),128))])):$("",!0)])]),e.showMapModal?(g(),f("div",Ds,[n("div",Ms,[n("h3",Ts,m(e.editingMap?"Редактировать маппинг":"Добавить маппинг"),1),n("form",{onSubmit:t[8]||(t[8]=ft((...s)=>e.saveMap&&e.saveMap(...s),["prevent"])),class:"space-y-4"},[n("div",null,[t[18]||(t[18]=n("label",{class:"block text-sm font-medium text-white mb-2"}," Маркетплейс ",-1)),X(n("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>e.mapForm.marketplace=s),required:"",disabled:e.editingMap,class:"w-full bg-gray-700 text-white px-4 py-2 rounded border border-gray-600 focus:border-blue-500 focus:outline-none disabled:opacity-50"},t[17]||(t[17]=[Be('<option value="" data-v-58f42a03>Выберите маркетплейс</option><option value="wildberries" data-v-58f42a03>Wildberries</option><option value="ozon" data-v-58f42a03>Ozon</option><option value="yandex_market" data-v-58f42a03>Яндекс.Маркет</option><option value="flowwow" data-v-58f42a03>Flowwow</option>',5)]),8,As),[[ut,e.mapForm.marketplace]])]),n("div",null,[t[20]||(t[20]=n("label",{class:"block text-sm font-medium text-white mb-2"}," Наш атрибут ",-1)),X(n("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>e.mapForm.our_attr_id=s),required:"",class:"w-full bg-gray-700 text-white px-4 py-2 rounded border border-gray-600 focus:border-blue-500 focus:outline-none"},[t[19]||(t[19]=n("option",{value:""},"Выберите атрибут",-1)),(g(!0),f(L,null,z(e.attributes,s=>(g(),f("option",{key:s.id,value:s.id},m(s.name),9,Is))),128))],512),[[ut,e.mapForm.our_attr_id]])]),n("div",null,[t[21]||(t[21]=n("label",{class:"block text-sm font-medium text-white mb-2"}," Название атрибута в маркетплейсе ",-1)),X(n("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>e.mapForm.marketplace_attr_name=s),type:"text",required:"",class:"w-full bg-gray-700 text-white px-4 py-2 rounded border border-gray-600 focus:border-blue-500 focus:outline-none",placeholder:"Например: brand, material, color"},null,512),[[bt,e.mapForm.marketplace_attr_name]])]),n("div",Os,[n("button",{type:"button",onClick:t[7]||(t[7]=(...s)=>e.closeMapModal&&e.closeMapModal(...s)),class:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700"}," Отмена "),n("button",{type:"submit",disabled:e.savingMap,class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50"},m(e.savingMap?"Сохранение...":"Сохранить"),9,Fs)])],32)])])):$("",!0)])}const js=Qt(ts,[["render",Ps],["__scopeId","data-v-58f42a03"]]);const Ns={name:"QuizAdmin",setup(){const o=S([]),t=S([]),r=S(""),e=S(!1),a=S(null),l=S(!1),s=S(""),d=S({month:"",day:"",hour_start:0,hour_end:23,stones:[]}),u=["агат","аметист","бирюза","гранат","жемчуг","изумруд","лазурит","малахит","опал","рубин","сапфир","топаз","турмалин","хризолит","янтарь"],c=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],b=w=>c[w-1]||"",i=async()=>{try{const w={};r.value&&(w.month=r.value);const E=await T.get("/admin/quiz-rules",{params:w});o.value=E.data.data||E.data||[]}catch(w){console.error("Ошибка загрузки правил:",w)}},y=async()=>{try{const w=await T.get("/admin/quiz-rules/stones");t.value=w.data||[]}catch(w){console.error("Ошибка загрузки камней:",w)}},C=()=>{const w=s.value.trim().toLowerCase();w&&!d.value.stones.includes(w)&&(d.value.stones.push(w),s.value="")},A=w=>{d.value.stones.includes(w)||d.value.stones.push(w)},_=w=>{d.value.stones.splice(w,1)},x=async()=>{var w,E;if(d.value.hour_end<d.value.hour_start){alert("Конечный час должен быть больше или равен начальному");return}l.value=!0;try{a.value?await T.put(`/admin/quiz-rules/${a.value.id}`,d.value):await T.post("/admin/quiz-rules",d.value),alert("Правило сохранено!"),P(),await i()}catch(j){console.error("Ошибка сохранения:",j);const Q=((E=(w=j.response)==null?void 0:w.data)==null?void 0:E.error)||"Ошибка сохранения правила";alert(Q)}finally{l.value=!1}},I=w=>{a.value=w,d.value={month:w.month,day:w.day,hour_start:w.hour_start,hour_end:w.hour_end,stones:[...w.stones]},e.value=!0},F=async w=>{const E=`${w.day} ${b(w.month)}`;if(confirm(`Удалить правило для ${E}?`))try{await T.delete(`/admin/quiz-rules/${w.id}`),alert("Правило удалено!"),await i()}catch(j){console.error("Ошибка удаления:",j),alert("Ошибка удаления правила")}},P=()=>{e.value=!1,a.value=null,d.value={month:"",day:"",hour_start:0,hour_end:23,stones:[]},s.value=""};return pe(()=>{i(),y()}),{rules:o,availableStones:t,filterMonth:r,showRuleModal:e,editingRule:a,savingRule:l,newStone:s,ruleForm:d,popularStones:u,getMonthName:b,loadRules:i,loadStones:y,addStone:C,quickAddStone:A,removeStone:_,saveRule:x,editRule:I,deleteRule:F,closeRuleModal:P}}},Vs={class:"quiz-admin p-6"},Rs={class:"bg-gray-800 rounded-lg p-6"},Us={class:"flex justify-between items-center mb-6"},Ls={class:"mb-4 flex gap-4"},zs=["value"],$s={class:"overflow-x-auto"},Bs={class:"w-full"},Xs={class:"py-3 px-4 text-white"},Ys={class:"py-3 px-4 text-white"},qs={class:"py-3 px-4"},Gs={class:"flex flex-wrap gap-1"},Hs={class:"py-3 px-4"},Ws=["onClick"],Qs=["onClick"],Ks={class:"mt-6"},Zs={class:"flex flex-wrap gap-2"},Js={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},ta={class:"bg-gray-800 rounded-lg p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto"},ea={class:"text-xl font-bold text-white mb-4"},oa={class:"grid grid-cols-2 gap-4"},na=["value"],ra={class:"grid grid-cols-2 gap-4"},sa=["value"],aa=["value"],ia={class:"mb-3 flex flex-wrap gap-2"},la=["onClick"],da={class:"flex gap-2"},ua={class:"mt-3"},ca={class:"flex flex-wrap gap-1"},ga=["onClick","disabled"],fa={class:"flex justify-end gap-3 pt-4"},ma=["disabled"];function pa(o,t,r,e,a,l){return g(),f("div",Vs,[n("div",Rs,[n("div",Us,[t[13]||(t[13]=n("h2",{class:"text-2xl font-bold text-white"},"Правила квиза",-1)),n("button",{onClick:t[0]||(t[0]=s=>e.showRuleModal=!0),class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-all"}," + Добавить правило ")]),n("div",Ls,[X(n("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>e.filterMonth=s),onChange:t[2]||(t[2]=(...s)=>e.loadRules&&e.loadRules(...s)),class:"bg-gray-700 text-white px-4 py-2 rounded border border-gray-600 focus:border-blue-500 focus:outline-none"},[t[14]||(t[14]=n("option",{value:""},"Все месяцы",-1)),(g(),f(L,null,z(12,s=>n("option",{key:s,value:s},m(e.getMonthName(s)),9,zs)),64))],544),[[ut,e.filterMonth]]),n("button",{onClick:t[3]||(t[3]=(...s)=>e.loadStones&&e.loadStones(...s)),class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-all"}," Обновить список камней ")]),n("div",$s,[n("table",Bs,[t[15]||(t[15]=n("thead",null,[n("tr",{class:"border-b border-gray-700"},[n("th",{class:"text-left py-3 px-4 text-gray-400"},"Дата"),n("th",{class:"text-left py-3 px-4 text-gray-400"},"Время"),n("th",{class:"text-left py-3 px-4 text-gray-400"},"Рекомендуемые камни"),n("th",{class:"text-left py-3 px-4 text-gray-400"},"Действия")])],-1)),n("tbody",null,[(g(!0),f(L,null,z(e.rules,s=>(g(),f("tr",{key:s.id,class:"border-b border-gray-700 hover:bg-gray-700/50 transition-colors"},[n("td",Xs,m(s.day)+" "+m(e.getMonthName(s.month)),1),n("td",Ys,m(s.hour_start)+":00 - "+m(s.hour_end)+":00 ",1),n("td",qs,[n("div",Gs,[(g(!0),f(L,null,z(s.stones,d=>(g(),f("span",{key:d,class:"bg-gray-700 text-white px-2 py-1 rounded text-sm"},m(d),1))),128))])]),n("td",Hs,[n("button",{onClick:d=>e.editRule(s),class:"text-blue-400 hover:text-blue-300 mr-3"}," Изменить ",8,Ws),n("button",{onClick:d=>e.deleteRule(s),class:"text-red-400 hover:text-red-300"}," Удалить ",8,Qs)])]))),128))])])]),n("div",Ks,[t[16]||(t[16]=n("h3",{class:"text-lg font-semibold text-white mb-3"},"Доступные камни",-1)),n("div",Zs,[(g(!0),f(L,null,z(e.availableStones,s=>(g(),f("span",{key:s,class:"bg-gray-700 text-white px-3 py-1 rounded"},m(s),1))),128))])])]),e.showRuleModal?(g(),f("div",Js,[n("div",ta,[n("h3",ea,m(e.editingRule?"Редактировать правило":"Добавить правило"),1),n("form",{onSubmit:t[12]||(t[12]=ft((...s)=>e.saveRule&&e.saveRule(...s),["prevent"])),class:"space-y-4"},[n("div",oa,[n("div",null,[t[17]||(t[17]=n("label",{class:"block text-sm font-medium text-white mb-2"}," День ",-1)),X(n("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>e.ruleForm.day=s),type:"number",min:"1",max:"31",required:"",class:"w-full bg-gray-700 text-white px-4 py-2 rounded border border-gray-600 focus:border-blue-500 focus:outline-none"},null,512),[[bt,e.ruleForm.day,void 0,{number:!0}]])]),n("div",null,[t[19]||(t[19]=n("label",{class:"block text-sm font-medium text-white mb-2"}," Месяц ",-1)),X(n("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>e.ruleForm.month=s),required:"",class:"w-full bg-gray-700 text-white px-4 py-2 rounded border border-gray-600 focus:border-blue-500 focus:outline-none"},[t[18]||(t[18]=n("option",{value:""},"Выберите месяц",-1)),(g(),f(L,null,z(12,s=>n("option",{key:s,value:s},m(e.getMonthName(s)),9,na)),64))],512),[[ut,e.ruleForm.month,void 0,{number:!0}]])])]),n("div",ra,[n("div",null,[t[20]||(t[20]=n("label",{class:"block text-sm font-medium text-white mb-2"}," Начальный час ",-1)),X(n("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>e.ruleForm.hour_start=s),required:"",class:"w-full bg-gray-700 text-white px-4 py-2 rounded border border-gray-600 focus:border-blue-500 focus:outline-none"},[(g(),f(L,null,z(24,s=>n("option",{key:s-1,value:s-1},m((s-1).toString().padStart(2,"0"))+":00 ",9,sa)),64))],512),[[ut,e.ruleForm.hour_start,void 0,{number:!0}]])]),n("div",null,[t[21]||(t[21]=n("label",{class:"block text-sm font-medium text-white mb-2"}," Конечный час ",-1)),X(n("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>e.ruleForm.hour_end=s),required:"",class:"w-full bg-gray-700 text-white px-4 py-2 rounded border border-gray-600 focus:border-blue-500 focus:outline-none"},[(g(),f(L,null,z(24,s=>n("option",{key:s-1,value:s-1},m((s-1).toString().padStart(2,"0"))+":00 ",9,aa)),64))],512),[[ut,e.ruleForm.hour_end,void 0,{number:!0}]])])]),n("div",null,[t[23]||(t[23]=n("label",{class:"block text-sm font-medium text-white mb-2"}," Рекомендуемые камни ",-1)),n("div",ia,[(g(!0),f(L,null,z(e.ruleForm.stones,(s,d)=>(g(),f("span",{key:d,class:"bg-blue-600 text-white px-3 py-1 rounded flex items-center gap-2"},[zt(m(s)+" ",1),n("button",{type:"button",onClick:u=>e.removeStone(d),class:"text-white hover:text-red-300"}," × ",8,la)]))),128))]),n("div",da,[X(n("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>e.newStone=s),type:"text",onKeyup:t[9]||(t[9]=Uo((...s)=>e.addStone&&e.addStone(...s),["enter"])),class:"flex-1 bg-gray-700 text-white px-4 py-2 rounded border border-gray-600 focus:border-blue-500 focus:outline-none",placeholder:"Введите название камня"},null,544),[[bt,e.newStone]]),n("button",{type:"button",onClick:t[10]||(t[10]=(...s)=>e.addStone&&e.addStone(...s)),class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"}," Добавить ")]),n("div",ua,[t[22]||(t[22]=n("p",{class:"text-sm text-gray-400 mb-2"},"Быстрый выбор:",-1)),n("div",ca,[(g(!0),f(L,null,z(e.popularStones,s=>(g(),f("button",{key:s,type:"button",onClick:d=>e.quickAddStone(s),disabled:e.ruleForm.stones.includes(s),class:"bg-gray-700 text-white px-2 py-1 rounded text-sm hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed"},m(s),9,ga))),128))])])]),n("div",fa,[n("button",{type:"button",onClick:t[11]||(t[11]=(...s)=>e.closeRuleModal&&e.closeRuleModal(...s)),class:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700"}," Отмена "),n("button",{type:"submit",disabled:e.savingRule||e.ruleForm.stones.length===0,class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50"},m(e.savingRule?"Сохранение...":"Сохранить"),9,ma)])],32)])])):$("",!0)])}const ha=Qt(Ns,[["render",pa],["__scopeId","data-v-e0125eb6"]]);const ba={name:"AdminPanel",components:{MarketplaceManager:Wn,ProductImageManager:Jr,MarketplaceAdmin:js,QuizAdmin:ha},setup(){const o=$o(),t=S("products"),r=S(!1),e=S(!1),a=S({data:[],current_page:1,last_page:1}),l=S([]),s=S([]),d=S([]),u=S([]),c=S(null),b=S([]),i=S(null),y=S(""),C=S(""),A=S("created_at"),_=S(!1),x=S(!1),I=S(!1),F=S(!1),P=Lt({id:null,name:"",parent_id:null,sort_order:0}),w=Lt({id:null,name:""}),E=Lt({id:null,name:""}),j=Lt({id:null,attribute_id:null,value:"",sort_order:0,is_active:!0}),Q=S([{id:"overview",name:"Обзор",icon:"📊"},{id:"products",name:"Товары",icon:"📦"},{id:"categories",name:"Категории",icon:"📂"},{id:"themes",name:"Темы",icon:"🎨"},{id:"attributes",name:"Атрибуты",icon:"🏷️"},{id:"images",name:"Изображения",icon:"🖼️"},{id:"marketplace",name:"Маркетплейсы",icon:"🛒"},{id:"quiz",name:"Квиз",icon:"🔮"}]),N=Lo(()=>{const v=[],V=a.value.current_page,et=a.value.last_page;for(let Y=Math.max(1,V-2);Y<=Math.min(et,V+2);Y++)v.push(Y);return v}),p=async()=>{try{const v=await T.get("/admin/stats");i.value=v.data}catch(v){console.error("Ошибка загрузки статистики:",v)}},k=async(v=1)=>{var V,et;try{r.value=!0;const Y={page:v,search:y.value||"",theme_id:C.value||"",sort_by:A.value||"created_at",per_page:15},K=await T.get("/admin/products",{params:Y});a.value=K.data}catch(Y){console.error("Ошибка загрузки товаров:",Y),((V=Y.response)==null?void 0:V.status)===500?alert("Ошибка сервера при загрузке товаров. Проверьте логи сервера."):((et=Y.response)==null?void 0:et.status)===404?alert("API метод не найден. Проверьте маршруты."):alert("Ошибка загрузки товаров: "+(Y.message||"Неизвестная ошибка"))}finally{r.value=!1}},B=async()=>{try{const v=await T.get("/admin/categories");l.value=v.data}catch(v){console.error("Ошибка загрузки категорий:",v)}},ct=async()=>{try{const v=await T.get("/admin/themes");s.value=v.data}catch(v){console.error("Ошибка загрузки тем:",v)}},tt=async()=>{try{const v=await T.get("/admin/attributes");d.value=v.data}catch(v){console.error("Ошибка загрузки атрибутов:",v)}},lt=async v=>{try{const V=await T.get(`/admin/attributes/${v}/values`);u.value=V.data.values}catch(V){console.error("Ошибка загрузки значений атрибутов:",V),u.value=[]}},pt=async()=>{try{r.value=!0;const v=await T.get("/admin/images");b.value=v.data.data||v.data}catch(v){console.error("Ошибка загрузки изображений:",v)}finally{r.value=!1}},ht=async v=>{if(confirm("Удалить этот товар? Это действие нельзя отменить."))try{await T.delete(`/admin/products/${v}`),alert("Товар удален!"),k(),p()}catch(V){console.error("Ошибка удаления товара:",V),alert("Ошибка удаления товара")}},Ot=()=>{Object.assign(P,{id:null,name:"",parent_id:null,sort_order:0}),_.value=!0},Dt=v=>{Object.assign(P,{id:v.id,name:v.name,parent_id:v.parent_id,sort_order:v.sort_order||0}),_.value=!0},be=async()=>{var v,V,et;if(!P.name.trim()){alert("Название категории обязательно");return}if(P.id&&P.parent_id===P.id){alert("Категория не может быть родителем самой себе");return}try{e.value=!0;const Y={name:P.name.trim(),parent_id:P.parent_id||null,sort_order:P.sort_order||0,meta_title:P.meta_title||null,meta_description:P.meta_description||null};let K;P.id?K=await T.put(`/admin/categories/${P.id}`,Y):K=await T.post("/admin/categories",Y),alert(K.data.message||"Категория сохранена!"),_.value=!1,B(),p()}catch(Y){if(console.error("Ошибка сохранения категории:",Y),((v=Y.response)==null?void 0:v.status)===422&&Y.response.data.errors){const K=Y.response.data.errors,Mt=Object.values(K).flat();alert(`Ошибки валидации:
`+Mt.join(`
`))}else alert("Ошибка сохранения категории: "+(((et=(V=Y.response)==null?void 0:V.data)==null?void 0:et.message)||Y.message))}finally{e.value=!1}},ze=async v=>{if(confirm("Удалить эту категорию? Все товары в ней потеряют категорию."))try{await T.delete(`/admin/categories/${v}`),alert("Категория удалена!"),B(),p()}catch(V){console.error("Ошибка удаления категории:",V),alert("Ошибка удаления категории")}},Jt=()=>{Object.assign(w,{id:null,name:""}),x.value=!0},ve=v=>{Object.assign(w,{id:v.id,name:v.name}),x.value=!0},ho=async()=>{try{e.value=!0,w.id?(await T.put(`/admin/themes/${w.id}`,w),alert("Тема обновлена!")):(await T.post("/admin/themes",w),alert("Тема создана!")),x.value=!1,ct(),p()}catch(v){console.error("Ошибка сохранения темы:",v),alert("Ошибка сохранения темы")}finally{e.value=!1}},bo=async v=>{if(confirm("Удалить эту тему? Все товары в ней потеряют тему."))try{await T.delete(`/admin/themes/${v}`),alert("Тема удалена!"),ct(),p()}catch(V){console.error("Ошибка удаления темы:",V),alert("Ошибка удаления темы")}},vo=v=>{c.value=v,lt(v.id)},yo=()=>{Object.assign(E,{id:null,name:""}),I.value=!0},xo=v=>{Object.assign(E,{id:v.id,name:v.name}),I.value=!0},_o=async()=>{try{e.value=!0,E.id?(await T.put(`/admin/attributes/${E.id}`,E),alert("Атрибут обновлен!")):(await T.post("/admin/attributes",E),alert("Атрибут создан!")),I.value=!1,tt()}catch(v){console.error("Ошибка сохранения атрибута:",v),alert("Ошибка сохранения атрибута")}finally{e.value=!1}},wo=async v=>{var V;if(confirm("Удалить этот атрибут? Все связанные товары потеряют этот атрибут."))try{await T.delete(`/admin/attributes/${v}`),alert("Атрибут удален!"),tt(),((V=c.value)==null?void 0:V.id)===v&&(c.value=null,u.value=[])}catch(et){console.error("Ошибка удаления атрибута:",et),alert("Ошибка удаления атрибута")}},ko=()=>{if(!c.value){alert("Сначала выберите атрибут");return}Object.assign(j,{id:null,attribute_id:c.value.id,value:"",sort_order:0,is_active:!0}),F.value=!0},Co=v=>{Object.assign(j,{id:v.id,attribute_id:v.attribute_id,value:v.value,sort_order:v.sort_order||0,is_active:v.is_active}),F.value=!0},Eo=async()=>{try{e.value=!0,j.id?(await T.put(`/admin/attribute-values/${j.id}`,j),alert("Значение обновлено!")):(await T.post(`/admin/attributes/${j.attribute_id}/values`,j),alert("Значение создано!")),F.value=!1,lt(c.value.id),tt()}catch(v){console.error("Ошибка сохранения значения:",v),alert("Ошибка сохранения значения")}finally{e.value=!1}},So=async v=>{if(confirm("Удалить это значение?"))try{await T.delete(`/admin/attribute-values/${v}`),alert("Значение удалено!"),lt(c.value.id),tt()}catch(V){console.error("Ошибка удаления значения:",V),alert("Ошибка удаления значения")}},Do=async v=>{var et,Y;const V=v.target.files;if(V.length)try{e.value=!0;for(let K=0;K<V.length;K++){const Mt=new FormData;Mt.append("image",V[K]),Mt.append("type","product");try{const ye=await T.post("/admin/images",Mt,{headers:{"Content-Type":"multipart/form-data"},timeout:3e4});console.log(`Файл ${K+1}/${V.length} загружен:`,ye.data.filename)}catch(ye){console.error(`Ошибка загрузки файла ${V[K].name}:`,ye)}}alert(`Загрузка завершена! Обработано файлов: ${V.length}`),pt()}catch(K){console.error("Общая ошибка загрузки изображений:",K),alert("Ошибка загрузки изображений: "+(((Y=(et=K.response)==null?void 0:et.data)==null?void 0:Y.message)||K.message))}finally{e.value=!1,v.target.value=""}},Mo=async v=>{if(confirm("Удалить это изображение?"))try{await T.delete(`/admin/images/${v}`),alert("Изображение удалено!"),pt()}catch(V){console.error("Ошибка удаления изображения:",V),alert("Ошибка удаления изображения")}},To=v=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(v),Ao=v=>new Date(v).toLocaleDateString("ru-RU"),Io=()=>{y.value="",C.value="",A.value="created_at",k()},Oo=Fo(()=>{k()},500);function Fo(v,V){let et;return function(...K){const Mt=()=>{clearTimeout(et),v(...K)};clearTimeout(et),et=setTimeout(Mt,V)}}const Po=async()=>{try{await T.post("/admin/logout")}catch(v){console.error("Ошибка выхода:",v)}finally{localStorage.removeItem("auth_token"),delete T.defaults.headers.common.Authorization,o.push("/admin/login")}};return pe(()=>{p(),k(),B(),ct(),tt(),pt()}),{activeTab:t,loading:r,saving:e,tabs:Q,products:a,categories:l,themes:s,attributes:d,attributeValues:u,selectedAttribute:c,images:b,stats:i,productSearch:y,productThemeFilter:C,productSort:A,showCategoryModal:_,showThemeModal:x,showAttributeModal:I,showAttributeValueModal:F,categoryForm:P,themeForm:w,attributeForm:E,attributeValueForm:j,paginationPages:N,loadProducts:k,loadCategories:B,loadThemes:ct,loadAttributes:tt,loadAttributeValues:lt,loadImages:pt,deleteProduct:ht,createCategory:Ot,editCategory:Dt,saveCategoryForm:be,deleteCategory:ze,createTheme:Jt,editTheme:ve,saveThemeForm:ho,deleteTheme:bo,selectAttribute:vo,createAttribute:yo,editAttribute:xo,saveAttributeForm:_o,deleteAttribute:wo,createAttributeValue:ko,editAttributeValue:Co,saveAttributeValueForm:Eo,deleteAttributeValue:So,uploadImages:Do,deleteImage:Mo,formatPrice:To,formatDate:Ao,clearFilters:Io,debouncedSearch:Oo,logout:Po}}},va={class:"admin-panel min-h-screen bg-gray-900 p-6"},ya={class:"max-w-7xl mx-auto"},xa={class:"flex justify-between items-center mb-8"},_a={class:"hidden lg:flex space-x-4"},wa={key:0,class:"bg-gray-800 rounded-lg p-4 text-center"},ka={class:"text-2xl font-bold text-blue-400"},Ca={key:1,class:"bg-gray-800 rounded-lg p-4 text-center"},Ea={class:"text-2xl font-bold text-green-400"},Sa={key:2,class:"bg-gray-800 rounded-lg p-4 text-center"},Da={class:"text-2xl font-bold text-purple-400"},Ma={class:"bg-gray-800 rounded-lg p-2 mb-8"},Ta={class:"flex flex-wrap space-x-1"},Aa=["onClick"],Ia={class:"bg-gray-800 rounded-lg p-6"},Oa={key:0},Fa={class:"flex justify-between items-center mb-6"},Pa={class:"flex space-x-2 action-buttons"},ja=["disabled"],Na={class:"bg-gray-700 rounded-lg p-4 mb-6"},Va={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Ra=["value"],Ua={class:"flex items-end"},La={class:"bg-gray-700 rounded-lg overflow-hidden table-responsive"},za={class:"w-full product-table"},$a={class:"px-4 py-3"},Ba={class:"flex items-center space-x-3"},Xa={class:"w-12 h-12 bg-gray-500 rounded-lg flex items-center justify-center"},Ya=["src"],qa={key:1,class:"text-gray-400 text-xs"},Ga={class:"text-white font-medium"},Ha={class:"text-gray-400 text-sm"},Wa={class:"px-4 py-3 text-white"},Qa={class:"px-4 py-3 text-gray-300"},Ka={class:"px-4 py-3"},Za={class:"px-4 py-3 text-gray-300"},Ja={class:"px-4 py-3"},ti={class:"flex justify-center space-x-2 action-buttons"},ei=["onClick"],oi={key:0,class:"bg-gray-600 px-4 py-3 flex justify-between items-center"},ni={class:"text-gray-300 text-sm"},ri={class:"flex space-x-2"},si=["onClick"],ai={key:1},ii={class:"flex justify-between items-center mb-6"},li={class:"bg-gray-700 rounded-lg overflow-hidden table-responsive"},di={class:"w-full category-table"},ui={class:"px-4 py-3"},ci={class:"text-white font-medium"},gi={class:"text-gray-400 text-sm"},fi={class:"px-4 py-3 text-gray-300"},mi={class:"px-4 py-3 text-gray-300"},pi={class:"px-4 py-3 text-gray-300"},hi={class:"px-4 py-3"},bi={class:"flex justify-center space-x-2 action-buttons"},vi=["onClick"],yi=["onClick"],xi={key:2},_i={class:"flex justify-between items-center mb-6"},wi={class:"bg-gray-700 rounded-lg overflow-hidden table-responsive"},ki={class:"w-full"},Ci={class:"px-4 py-3 text-white font-medium"},Ei={class:"px-4 py-3 text-gray-300"},Si={class:"px-4 py-3 text-gray-300"},Di={class:"px-4 py-3"},Mi={class:"flex justify-center space-x-2 action-buttons"},Ti=["onClick"],Ai=["onClick"],Ii={key:3},Oi={class:"flex justify-between items-center mb-6"},Fi={class:"form-grid"},Pi={class:"bg-gray-700 rounded-lg overflow-hidden"},ji={class:"max-h-96 overflow-y-auto"},Ni=["onClick"],Vi={class:"flex justify-between items-center"},Ri={class:"text-white font-medium"},Ui={class:"text-gray-400 text-sm"},Li={key:0,class:"ml-2 px-2 py-1 bg-purple-600 text-purple-100 rounded-full text-xs"},zi={class:"flex space-x-2"},$i=["onClick"],Bi=["onClick"],Xi={class:"bg-gray-700 rounded-lg overflow-hidden"},Yi={class:"bg-gray-600 px-4 py-3 flex justify-between items-center"},qi={class:"text-white font-medium"},Gi={class:"max-h-96 overflow-y-auto"},Hi={key:0},Wi={class:"flex justify-between items-center"},Qi={class:"text-white font-medium"},Ki={class:"text-gray-400 text-sm"},Zi={key:0,class:"ml-2 px-2 py-1 bg-gray-500 text-gray-200 rounded-full text-xs"},Ji={class:"flex space-x-2"},tl=["onClick"],el=["onClick"],ol={key:1,class:"px-4 py-8 text-center text-gray-400"},nl={key:2,class:"px-4 py-8 text-center text-gray-400"},rl={key:4},sl={class:"flex justify-between items-center mb-6"},al={class:"flex space-x-2 action-buttons"},il=["disabled"],ll={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4"},dl=["src"],ul={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-opacity flex items-center justify-center"},cl=["onClick"],gl={class:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-75 text-white p-2"},fl={class:"text-xs truncate"},ml={key:0,class:"text-center py-12 text-gray-400"},pl={class:"marketplace-section"},hl={class:"quiz-section"},bl={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},vl={class:"bg-gray-800 rounded-lg p-6 max-w-md w-full"},yl={class:"text-xl text-white mb-4"},xl={class:"space-y-4"},_l=["value"],wl={class:"flex justify-end space-x-3 mt-6"},kl=["disabled"],Cl={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},El={class:"bg-gray-800 rounded-lg p-6 max-w-md w-full"},Sl={class:"text-xl text-white mb-4"},Dl={class:"space-y-4"},Ml={class:"flex justify-end space-x-3 mt-6"},Tl=["disabled"],Al={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},Il={class:"bg-gray-800 rounded-lg p-6 max-w-md w-full"},Ol={class:"text-xl text-white mb-4"},Fl={class:"space-y-4"},Pl={class:"flex justify-end space-x-3 mt-6"},jl=["disabled"],Nl={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},Vl={class:"bg-gray-800 rounded-lg p-6 max-w-md w-full"},Rl={class:"text-xl text-white mb-4"},Ul={class:"space-y-4"},Ll={class:"flex items-center"},zl={class:"flex justify-end space-x-3 mt-6"},$l=["disabled"];function Bl(o,t,r,e,a,l){var c,b;const s=re("router-link"),d=re("MarketplaceAdmin"),u=re("QuizAdmin");return g(),f("div",va,[n("div",ya,[n("div",xa,[t[37]||(t[37]=n("div",null,[n("h1",{class:"text-3xl font-bold text-white"},'Админ-панель "Стужа"'),n("p",{class:"text-gray-400 mt-1"},"Управление интернет-магазином украшений")],-1)),n("div",_a,[e.stats?(g(),f("div",wa,[n("div",ka,m(((c=e.stats.products)==null?void 0:c.total)||0),1),t[34]||(t[34]=n("div",{class:"text-gray-400 text-sm"},"Товаров",-1))])):$("",!0),e.stats?(g(),f("div",Ca,[n("div",Ea,m(e.stats.categories||0),1),t[35]||(t[35]=n("div",{class:"text-gray-400 text-sm"},"Категорий",-1))])):$("",!0),e.stats?(g(),f("div",Sa,[n("div",Da,m(((b=e.stats.products)==null?void 0:b.matryoshka)||0),1),t[36]||(t[36]=n("div",{class:"text-gray-400 text-sm"},"Матрёшек",-1))])):$("",!0)]),n("button",{onClick:t[0]||(t[0]=(...i)=>e.logout&&e.logout(...i)),class:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors"}," Выйти ")]),n("div",Ma,[n("nav",Ta,[(g(!0),f(L,null,z(e.tabs,i=>(g(),f("button",{key:i.id,onClick:y=>e.activeTab=i.id,class:mt(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",e.activeTab===i.id?"bg-blue-600 text-white":"text-gray-400 hover:bg-gray-700 hover:text-white"])},m(i.name),11,Aa))),128))])]),n("div",Ia,[e.activeTab==="products"?(g(),f("div",Oa,[n("div",Fa,[t[39]||(t[39]=n("h2",{class:"text-xl font-semibold text-white"},"Управление товарами",-1)),n("div",Pa,[Ut(s,{to:"/admin/products/create",class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors button"},{default:Ie(()=>t[38]||(t[38]=[zt(" + Создать товар ")])),_:1,__:[38]}),n("button",{onClick:t[1]||(t[1]=(...i)=>e.loadProducts&&e.loadProducts(...i)),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",disabled:e.loading},m(e.loading?"Загрузка...":"Обновить"),9,ja)])]),n("div",Na,[n("div",Va,[n("div",null,[t[40]||(t[40]=n("label",{class:"block text-sm font-medium text-white mb-2"},"Поиск",-1)),X(n("input",{"onUpdate:modelValue":t[2]||(t[2]=i=>e.productSearch=i),type:"text",placeholder:"Название товара...",class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-3 py-2 text-white",onInput:t[3]||(t[3]=(...i)=>e.debouncedSearch&&e.debouncedSearch(...i))},null,544),[[bt,e.productSearch]])]),n("div",null,[t[42]||(t[42]=n("label",{class:"block text-sm font-medium text-white mb-2"},"Тема",-1)),X(n("select",{"onUpdate:modelValue":t[4]||(t[4]=i=>e.productThemeFilter=i),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-3 py-2 text-white",onChange:t[5]||(t[5]=(...i)=>e.loadProducts&&e.loadProducts(...i))},[t[41]||(t[41]=n("option",{value:""},"Все темы",-1)),(g(!0),f(L,null,z(e.themes,i=>(g(),f("option",{key:i.id,value:i.id},m(i.name),9,Ra))),128))],544),[[ut,e.productThemeFilter]])]),n("div",null,[t[44]||(t[44]=n("label",{class:"block text-sm font-medium text-white mb-2"},"Сортировка",-1)),X(n("select",{"onUpdate:modelValue":t[6]||(t[6]=i=>e.productSort=i),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-3 py-2 text-white",onChange:t[7]||(t[7]=(...i)=>e.loadProducts&&e.loadProducts(...i))},t[43]||(t[43]=[n("option",{value:"created_at"},"По дате создания",-1),n("option",{value:"name"},"По названию",-1),n("option",{value:"price"},"По цене",-1)]),544),[[ut,e.productSort]])]),n("div",Ua,[n("button",{onClick:t[8]||(t[8]=(...i)=>e.clearFilters&&e.clearFilters(...i)),class:"bg-gray-600 hover:bg-gray-500 text-white px-4 py-2 rounded-lg transition-colors w-full"}," Сбросить ")])])]),n("div",La,[n("table",za,[t[46]||(t[46]=n("thead",{class:"bg-gray-600"},[n("tr",null,[n("th",{class:"px-4 py-3 text-left text-white font-medium"},"Товар"),n("th",{class:"px-4 py-3 text-left text-white font-medium"},"Цена"),n("th",{class:"px-4 py-3 text-left text-white font-medium"},"Тема"),n("th",{class:"px-4 py-3 text-left text-white font-medium"},"Тип"),n("th",{class:"px-4 py-3 text-left text-white font-medium"},"Дата"),n("th",{class:"px-4 py-3 text-center text-white font-medium"},"Действия")])],-1)),n("tbody",null,[(g(!0),f(L,null,z(e.products.data,i=>{var y;return g(),f("tr",{key:i.id,class:"border-t border-gray-600 hover:bg-gray-600"},[n("td",$a,[n("div",Ba,[n("div",Xa,[i.main_image?(g(),f("img",{key:0,src:`/storage/images/products/${i.main_image}`,class:"w-full h-full object-cover rounded-lg",onError:t[9]||(t[9]=C=>C.target.style.display="none")},null,40,Ya)):(g(),f("span",qa,"Нет фото"))]),n("div",null,[n("div",Ga,m(i.name),1),n("div",Ha,m(i.slug),1)])])]),n("td",Wa,m(e.formatPrice(i.price)),1),n("td",Qa,m(((y=i.theme)==null?void 0:y.name)||"Без темы"),1),n("td",Ka,[n("span",{class:mt(["px-2 py-1 rounded-full text-xs font-medium",i.use_matryoshka?"bg-purple-600 text-purple-100":"bg-blue-600 text-blue-100"])},m(i.use_matryoshka?"Матрёшка":"Обычный"),3)]),n("td",Za,m(e.formatDate(i.created_at)),1),n("td",Ja,[n("div",ti,[Ut(s,{to:`/admin/products/edit/${i.id}`,class:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors button"},{default:Ie(()=>t[45]||(t[45]=[zt(" Редактировать ")])),_:2,__:[45]},1032,["to"]),n("button",{onClick:C=>e.deleteProduct(i.id),class:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition-colors"}," Удалить ",8,ei)])])])}),128))])]),e.products.last_page>1?(g(),f("div",oi,[n("div",ni," Показано "+m(e.products.from)+"-"+m(e.products.to)+" из "+m(e.products.total),1),n("div",ri,[(g(!0),f(L,null,z(e.paginationPages,i=>(g(),f("button",{key:i,onClick:y=>e.loadProducts(i),class:mt(["px-3 py-1 rounded text-sm transition-colors",i===e.products.current_page?"bg-blue-600 text-white":"bg-gray-500 text-gray-300 hover:bg-gray-400"])},m(i),11,si))),128))])])):$("",!0)])])):$("",!0),e.activeTab==="categories"?(g(),f("div",ai,[n("div",ii,[t[47]||(t[47]=n("h2",{class:"text-xl font-semibold text-white"},"Управление категориями",-1)),n("button",{onClick:t[10]||(t[10]=(...i)=>e.createCategory&&e.createCategory(...i)),class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors"}," + Создать категорию ")]),n("div",li,[n("table",di,[t[48]||(t[48]=n("thead",{class:"bg-gray-600"},[n("tr",null,[n("th",{class:"px-4 py-3 text-left text-white font-medium"},"Название"),n("th",{class:"px-4 py-3 text-left text-white font-medium"},"Родитель"),n("th",{class:"px-4 py-3 text-left text-white font-medium"},"Товаров"),n("th",{class:"px-4 py-3 text-left text-white font-medium"},"Порядок"),n("th",{class:"px-4 py-3 text-center text-white font-medium"},"Действия")])],-1)),n("tbody",null,[(g(!0),f(L,null,z(e.categories,i=>{var y;return g(),f("tr",{key:i.id,class:"border-t border-gray-600 hover:bg-gray-600"},[n("td",ui,[n("div",ci,m(i.name),1),n("div",gi,m(i.slug),1)]),n("td",fi,m(((y=i.parent)==null?void 0:y.name)||"Корневая"),1),n("td",mi,m(i.products_count||0),1),n("td",pi,m(i.sort_order||0),1),n("td",hi,[n("div",bi,[n("button",{onClick:C=>e.editCategory(i),class:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors"}," Редактировать ",8,vi),n("button",{onClick:C=>e.deleteCategory(i.id),class:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition-colors"}," Удалить ",8,yi)])])])}),128))])])])])):$("",!0),e.activeTab==="themes"?(g(),f("div",xi,[n("div",_i,[t[49]||(t[49]=n("h2",{class:"text-xl font-semibold text-white"},"Управление темами",-1)),n("button",{onClick:t[11]||(t[11]=(...i)=>e.createTheme&&e.createTheme(...i)),class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors"}," + Создать тему ")]),n("div",wi,[n("table",ki,[t[50]||(t[50]=n("thead",{class:"bg-gray-600"},[n("tr",null,[n("th",{class:"px-4 py-3 text-left text-white font-medium"},"Название"),n("th",{class:"px-4 py-3 text-left text-white font-medium"},"Товаров"),n("th",{class:"px-4 py-3 text-left text-white font-medium"},"Дата создания"),n("th",{class:"px-4 py-3 text-center text-white font-medium"},"Действия")])],-1)),n("tbody",null,[(g(!0),f(L,null,z(e.themes,i=>(g(),f("tr",{key:i.id,class:"border-t border-gray-600 hover:bg-gray-600"},[n("td",Ci,m(i.name),1),n("td",Ei,m(i.products_count||0),1),n("td",Si,m(e.formatDate(i.created_at)),1),n("td",Di,[n("div",Mi,[n("button",{onClick:y=>e.editTheme(i),class:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors"}," Редактировать ",8,Ti),n("button",{onClick:y=>e.deleteTheme(i.id),class:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition-colors"}," Удалить ",8,Ai)])])]))),128))])])])])):$("",!0),e.activeTab==="attributes"?(g(),f("div",Ii,[n("div",Oi,[t[51]||(t[51]=n("h2",{class:"text-xl font-semibold text-white"},"Управление атрибутами",-1)),n("button",{onClick:t[12]||(t[12]=(...i)=>e.createAttribute&&e.createAttribute(...i)),class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors"}," + Создать атрибут ")]),n("div",Fi,[n("div",Pi,[t[52]||(t[52]=n("div",{class:"bg-gray-600 px-4 py-3"},[n("h3",{class:"text-white font-medium"},"Атрибуты")],-1)),n("div",ji,[(g(!0),f(L,null,z(e.attributes,i=>{var y;return g(),f("div",{key:i.id,class:mt(["px-4 py-3 border-b border-gray-600 hover:bg-gray-600 cursor-pointer",((y=e.selectedAttribute)==null?void 0:y.id)===i.id?"bg-gray-600":""]),onClick:C=>e.selectAttribute(i)},[n("div",Vi,[n("div",null,[n("div",Ri,m(i.name),1),n("div",Ui,[zt(m(i.values_count||0)+" значений, "+m(i.products_count||0)+" товаров ",1),i.is_stone?(g(),f("span",Li," Камень ")):$("",!0)])]),n("div",zi,[n("button",{onClick:ft(C=>e.editAttribute(i),["stop"]),class:"bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded text-xs transition-colors"}," Редактировать ",8,$i),n("button",{onClick:ft(C=>e.deleteAttribute(i.id),["stop"]),class:"bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-xs transition-colors"}," Удалить ",8,Bi)])])],10,Ni)}),128))])]),n("div",Xi,[n("div",Yi,[n("h3",qi,m(e.selectedAttribute?`Значения: ${e.selectedAttribute.name}`:"Выберите атрибут"),1),e.selectedAttribute?(g(),f("button",{key:0,onClick:t[13]||(t[13]=(...i)=>e.createAttributeValue&&e.createAttributeValue(...i)),class:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm transition-colors"}," + Добавить ")):$("",!0)]),n("div",Gi,[e.selectedAttribute&&e.attributeValues.length>0?(g(),f("div",Hi,[(g(!0),f(L,null,z(e.attributeValues,i=>(g(),f("div",{key:i.id,class:"px-4 py-3 border-b border-gray-600 hover:bg-gray-600"},[n("div",Wi,[n("div",null,[n("div",Qi,m(i.value),1),n("div",Ki,[zt(m(i.products_count||0)+" товаров ",1),i.is_active?$("",!0):(g(),f("span",Zi," Неактивен "))])]),n("div",Ji,[n("button",{onClick:y=>e.editAttributeValue(i),class:"bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded text-xs transition-colors"}," Редактировать ",8,tl),n("button",{onClick:y=>e.deleteAttributeValue(i.id),class:"bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-xs transition-colors"}," Удалить ",8,el)])])]))),128))])):e.selectedAttribute?(g(),f("div",ol," У этого атрибута пока нет значений ")):(g(),f("div",nl," Выберите атрибут для просмотра его значений "))])])])])):$("",!0),e.activeTab==="images"?(g(),f("div",rl,[n("div",sl,[t[53]||(t[53]=n("h2",{class:"text-xl font-semibold text-white"},"Управление изображениями",-1)),n("div",al,[n("input",{ref:"imageUpload",type:"file",multiple:"",accept:"image/*",onChange:t[14]||(t[14]=(...i)=>e.uploadImages&&e.uploadImages(...i)),class:"hidden"},null,544),n("button",{onClick:t[15]||(t[15]=i=>o.$refs.imageUpload.click()),class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors clickable"}," + Загрузить изображения "),n("button",{onClick:t[16]||(t[16]=(...i)=>e.loadImages&&e.loadImages(...i)),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",disabled:e.loading},m(e.loading?"Загрузка...":"Обновить"),9,il)])]),n("div",ll,[(g(!0),f(L,null,z(e.images,i=>(g(),f("div",{key:i.filename,class:"relative group bg-gray-700 rounded-lg overflow-hidden"},[n("img",{src:i.path,class:"w-full h-32 object-cover",onError:t[17]||(t[17]=y=>y.target.style.display="none")},null,40,dl),n("div",ul,[n("button",{onClick:y=>e.deleteImage(i.filename),class:"bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-sm transition-colors opacity-0 group-hover:opacity-100"}," Удалить ",8,cl)]),n("div",gl,[n("div",fl,m(i.filename),1)])]))),128))]),e.images.length===0?(g(),f("div",ml," Нет загруженных изображений ")):$("",!0)])):$("",!0),X(n("div",pl,[Ut(d)],512),[[Xe,e.activeTab==="marketplace"]]),X(n("div",hl,[Ut(u)],512),[[Xe,e.activeTab==="quiz"]])])]),e.showCategoryModal?(g(),f("div",bl,[n("div",vl,[n("h3",yl,m(e.categoryForm.id?"Редактировать категорию":"Создать категорию"),1),n("form",{onSubmit:t[22]||(t[22]=ft((...i)=>e.saveCategoryForm&&e.saveCategoryForm(...i),["prevent"]))},[n("div",xl,[n("div",null,[t[54]||(t[54]=n("label",{class:"block text-sm font-medium text-white mb-2"},"Название",-1)),X(n("input",{"onUpdate:modelValue":t[18]||(t[18]=i=>e.categoryForm.name=i),type:"text",required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},null,512),[[bt,e.categoryForm.name]])]),n("div",null,[t[56]||(t[56]=n("label",{class:"block text-sm font-medium text-white mb-2"},"Родительская категория",-1)),X(n("select",{"onUpdate:modelValue":t[19]||(t[19]=i=>e.categoryForm.parent_id=i),class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},[t[55]||(t[55]=n("option",{value:""},"Корневая категория",-1)),(g(!0),f(L,null,z(e.categories,i=>(g(),f("option",{key:i.id,value:i.id},m(i.name),9,_l))),128))],512),[[ut,e.categoryForm.parent_id]])]),n("div",null,[t[57]||(t[57]=n("label",{class:"block text-sm font-medium text-white mb-2"},"Порядок сортировки",-1)),X(n("input",{"onUpdate:modelValue":t[20]||(t[20]=i=>e.categoryForm.sort_order=i),type:"number",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},null,512),[[bt,e.categoryForm.sort_order,void 0,{number:!0}]])])]),n("div",wl,[n("button",{type:"button",onClick:t[21]||(t[21]=i=>e.showCategoryModal=!1),class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"}," Отмена "),n("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",disabled:e.saving},m(e.saving?"Сохранение...":"Сохранить"),9,kl)])],32)])])):$("",!0),e.showThemeModal?(g(),f("div",Cl,[n("div",El,[n("h3",Sl,m(e.themeForm.id?"Редактировать тему":"Создать тему"),1),n("form",{onSubmit:t[25]||(t[25]=ft((...i)=>e.saveThemeForm&&e.saveThemeForm(...i),["prevent"]))},[n("div",Dl,[n("div",null,[t[58]||(t[58]=n("label",{class:"block text-sm font-medium text-white mb-2"},"Название",-1)),X(n("input",{"onUpdate:modelValue":t[23]||(t[23]=i=>e.themeForm.name=i),type:"text",required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},null,512),[[bt,e.themeForm.name]])])]),n("div",Ml,[n("button",{type:"button",onClick:t[24]||(t[24]=i=>e.showThemeModal=!1),class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"}," Отмена "),n("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",disabled:e.saving},m(e.saving?"Сохранение...":"Сохранить"),9,Tl)])],32)])])):$("",!0),e.showAttributeModal?(g(),f("div",Al,[n("div",Il,[n("h3",Ol,m(e.attributeForm.id?"Редактировать атрибут":"Создать атрибут"),1),n("form",{onSubmit:t[28]||(t[28]=ft((...i)=>e.saveAttributeForm&&e.saveAttributeForm(...i),["prevent"]))},[n("div",Fl,[n("div",null,[t[59]||(t[59]=n("label",{class:"block text-sm font-medium text-white mb-2"},"Название",-1)),X(n("input",{"onUpdate:modelValue":t[26]||(t[26]=i=>e.attributeForm.name=i),type:"text",required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},null,512),[[bt,e.attributeForm.name]])])]),n("div",Pl,[n("button",{type:"button",onClick:t[27]||(t[27]=i=>e.showAttributeModal=!1),class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"}," Отмена "),n("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",disabled:e.saving},m(e.saving?"Сохранение...":"Сохранить"),9,jl)])],32)])])):$("",!0),e.showAttributeValueModal?(g(),f("div",Nl,[n("div",Vl,[n("h3",Rl,m(e.attributeValueForm.id?"Редактировать значение":"Создать значение"),1),n("form",{onSubmit:t[33]||(t[33]=ft((...i)=>e.saveAttributeValueForm&&e.saveAttributeValueForm(...i),["prevent"]))},[n("div",Ul,[n("div",null,[t[60]||(t[60]=n("label",{class:"block text-sm font-medium text-white mb-2"},"Значение",-1)),X(n("input",{"onUpdate:modelValue":t[29]||(t[29]=i=>e.attributeValueForm.value=i),type:"text",required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},null,512),[[bt,e.attributeValueForm.value]])]),n("div",null,[t[61]||(t[61]=n("label",{class:"block text-sm font-medium text-white mb-2"},"Порядок сортировки",-1)),X(n("input",{"onUpdate:modelValue":t[30]||(t[30]=i=>e.attributeValueForm.sort_order=i),type:"number",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},null,512),[[bt,e.attributeValueForm.sort_order,void 0,{number:!0}]])]),n("div",Ll,[X(n("input",{"onUpdate:modelValue":t[31]||(t[31]=i=>e.attributeValueForm.is_active=i),type:"checkbox",id:"is_active",class:"mr-2"},null,512),[[zo,e.attributeValueForm.is_active]]),t[62]||(t[62]=n("label",{for:"is_active",class:"text-white"},"Активно",-1))])]),n("div",zl,[n("button",{type:"button",onClick:t[32]||(t[32]=i=>e.showAttributeValueModal=!1),class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"}," Отмена "),n("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",disabled:e.saving},m(e.saving?"Сохранение...":"Сохранить"),9,$l)])],32)])])):$("",!0)])}const Yl=Qt(ba,[["render",Bl],["__scopeId","data-v-e9493da8"]]);export{Yl as default};
