import{_ as se,g as f,p as ne,h as ae,o as ie,r as de,a as n,c as a,b as e,t as g,d as ue,w as me,e as ge,m as b,s as ce,j as c,v as y,k as be,F as x,l as v,z as T,y as ye,x as pe,n as w}from"./main-8c208f58.js";const fe={name:"ProductCreate",setup(){const h=ye(),t=pe(),k=f(!1),o=f(!1),V=ne(()=>t.params.id?"edit":"create"),C=f([]),I=f([]),l=f([]),u=f([]),p=f(!1),U=f(null),S=f(null),m=ae({name:"",sku:"",description:"",price:0,stock_quantity:0,weight:0,use_matryoshka:!1,image_layers:{outer:"",inner:""},gallery_images:[""],theme_id:"",category_ids:[],attribute_values:{},meta_title:"",meta_description:"",dimensions:{length:0,width:0,height:0}}),N=async()=>{try{const r=await w.get("/admin/themes");C.value=r.data}catch(r){console.error("Ошибка загрузки тем:",r)}},M=async()=>{try{const r=await w.get("/admin/categories/tree");I.value=r.data}catch(r){console.error("Ошибка загрузки категорий:",r)}},D=async()=>{try{const r=await w.get("/admin/attributes");l.value=r.data}catch(r){console.error("Ошибка загрузки атрибутов:",r)}},P=async()=>{try{const r=await w.get("/admin/images");u.value=r.data}catch(r){console.error("Ошибка загрузки изображений:",r)}},q=async()=>{try{k.value=!0;const s=(await w.get(`/admin/products/${t.params.id}`)).data,i={};s.product_attributes&&s.product_attributes.forEach(d=>{d.attribute_value_id&&(i[d.attribute_id]||(i[d.attribute_id]=[]),i[d.attribute_id].push(d.attribute_value_id)),d.custom_value&&(i[`custom_${d.attribute_id}`]=d.custom_value)}),Object.assign(m,{...s,attribute_values:i})}catch(r){console.error("Ошибка загрузки товара:",r),alert("Ошибка загрузки товара"),h.push("/admin")}finally{k.value=!1}},G=(r,s)=>{m.attribute_values[r]||(m.attribute_values[r]=[]);const i=m.attribute_values[r],d=i.indexOf(s);d>-1?i.splice(d,1):i.push(s)},O=(r,s)=>{m.attribute_values[`custom_${r}`]=s.trim()},F=(r,s)=>{const i=m.attribute_values[r];return i&&i.includes(s)},K=r=>{var s;return((s=m.attribute_values[r])==null?void 0:s.customValue)||""},B=()=>{m.gallery_images.push("")},R=r=>{m.gallery_images.splice(r,1)},z=(r,s=null)=>{U.value=r,S.value=s,p.value=!0,P()},j=()=>{p.value=!1,U.value=null,S.value=null},J=r=>{const s=U.value;s==="outer"?m.image_layers.outer=r:s==="inner"?m.image_layers.inner=r:s==="gallery"&&(m.gallery_images[S.value]=r),j()},L=async r=>{const s=r.target.files;if(!s.length)return;const i=new FormData;for(let d of s)i.append("images[]",d);try{o.value=!0,await w.post("/admin/images/upload",i,{headers:{"Content-Type":"multipart/form-data"}}),alert("Изображения загружены!"),P()}catch(d){console.error("Ошибка загрузки изображений:",d),alert("Ошибка загрузки изображений")}finally{o.value=!1}},A=()=>{const r="STJ",s=Date.now().toString().slice(-6),i=Math.random().toString(36).substring(2,5).toUpperCase();m.sku=`${r}-${s}-${i}`},H=()=>{m.name&&!m.meta_title&&(m.meta_title=`${m.name} - купить в интернет-магазине Стужа`),m.description&&!m.meta_description&&(m.meta_description=m.description.substring(0,150)+"...")},Q=r=>new Intl.NumberFormat("ru-RU").format(r),W=r=>{const s=i=>{for(const d of i){if(d.id===r)return d.name;if(d.children){const _=s(d.children);if(_)return _}}return null};return s(I.value)||"Неизвестная категория"},X=r=>{const s=C.value.find(i=>i.id===r);return s?s.name:"Неизвестная тема"},Y=r=>{const s=l.value.find(i=>i.id===parseInt(r));return s?s.name:"Неизвестный атрибут"},Z=(r,s)=>{const i=l.value.find(_=>_.id===parseInt(r));if(!i)return"";const d=[];return s.valueIds.forEach(_=>{const E=i.values.find(re=>re.id===_);E&&d.push(E.value)}),s.customValue&&d.push(`"${s.customValue}"`),d.join(", ")},$=r=>`/storage/images/${r}`,ee=r=>{r.target.src="/images/placeholder.jpg"},te=()=>{window.open(`/product/${m.slug||m.name}`,"_blank")},oe=async()=>{var r,s;try{k.value=!0;const i={...m,attributes:m.attribute_values},d=V.value==="edit",_=d?`/admin/products/${t.params.id}`:"/admin/products";await w[d?"put":"post"](_,i),alert(d?"Товар обновлен!":"Товар создан!"),h.push("/admin")}catch(i){console.error("Ошибка сохранения товара:",i);const d=((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Ошибка сохранения";alert("Ошибка: "+d)}finally{k.value=!1}},le=async()=>{if(confirm("Вы уверены, что хотите удалить этот товар? Это действие нельзя отменить."))try{await w.delete(`/admin/products/${t.params.id}`),alert("Товар удален!"),h.push("/admin")}catch(r){console.error("Ошибка удаления товара:",r),alert("Ошибка удаления товара")}};return ie(async()=>{try{await Promise.all([N(),M(),D(),q()]),V.value==="create"&&!m.sku&&A()}catch(r){console.error("Ошибка инициализации:",r)}}),{loading:k,saving:o,mode:V,themes:C,categoryTree:I,attributes:l,availableImages:u,form:m,showImageSelector:p,toggleAttributeValue:G,setCustomAttributeValue:O,isAttributeValueSelected:F,getCustomAttributeValue:K,addGalleryImage:B,removeGalleryImage:R,openImageSelector:z,closeImageSelector:j,selectImage:J,uploadNewImages:L,generateSKU:A,generateMetaTags:H,formatPrice:Q,getCategoryName:W,getThemeName:X,getAttributeName:Y,getAttributeDisplayValue:Z,getImageUrl:$,handleImageError:ee,previewProduct:te,saveProduct:oe,deleteProduct:le}}},xe={class:"min-h-screen bg-gray-900 p-6"},ve={class:"max-w-7xl mx-auto"},he={class:"flex justify-between items-center mb-8"},_e={class:"text-3xl font-bold text-white"},we={class:"flex space-x-3"},ke={key:0,class:"flex justify-center items-center py-12"},Ie={class:"lg:col-span-2 space-y-8"},Ve={class:"bg-gray-800 rounded-lg p-6"},Ce={class:"space-y-6"},Ue={class:"flex space-x-2"},Se={class:"grid grid-cols-2 gap-4"},Ee={class:"grid grid-cols-2 gap-4"},Te=["value"],Pe={class:"grid grid-cols-3 gap-4"},je={class:"bg-gray-800 rounded-lg p-6"},Ae={class:"mb-6"},Ne={class:"flex items-center space-x-3"},Me={key:0,class:"space-y-4 mb-6"},De={class:"flex space-x-4"},qe={key:0,class:"mt-2"},Ge=["src"],Oe={class:"flex space-x-4"},Fe={key:0,class:"mt-2"},Ke=["src"],Be={key:1},Re={class:"space-y-4"},ze=["onUpdate:modelValue"],Je=["onClick"],Le=["onClick"],He={key:0,class:"w-16 h-16"},Qe=["src","alt"],We={class:"mt-6 pt-6 border-t border-gray-700"},Xe={class:"bg-gray-800 rounded-lg p-6"},Ye={class:"space-y-4"},Ze={class:"text-xs text-gray-400 mt-1"},$e={class:"text-xs text-gray-400 mt-1"},et={class:"space-y-8"},tt={class:"bg-gray-800 rounded-lg p-6"},ot={class:"space-y-2 max-h-64 overflow-y-auto"},lt={class:"flex items-center space-x-3 cursor-pointer p-2 hover:bg-gray-700 rounded"},rt=["value"],st={class:"text-white"},nt={class:"text-gray-400 text-sm"},at={key:0,class:"ml-6 space-y-1"},it=["value"],dt={class:"text-gray-300"},ut={class:"text-gray-400 text-sm"},mt={key:0,class:"text-gray-400 text-center py-4"},gt={class:"bg-gray-800 rounded-lg p-6"},ct={class:"space-y-6"},bt={class:"text-white font-medium mb-3 flex items-center space-x-2"},yt={key:0,class:"bg-purple-600 text-white px-2 py-1 rounded text-xs"},pt={key:0,class:"mb-4"},ft={class:"grid grid-cols-2 gap-2"},xt=["checked","onChange"],vt={class:"text-white text-sm"},ht=["value","onInput","placeholder"],_t={key:0,class:"text-gray-400 text-center py-4"},wt={class:"bg-gray-800 rounded-lg p-6"},kt={class:"space-y-3 text-sm"},It={class:"text-white ml-2"},Vt={class:"text-white ml-2"},Ct={class:"text-white ml-2"},Ut={class:"ml-2 mt-1"},St={key:0,class:"text-gray-400"},Et={class:"ml-2 mt-1 space-y-1"},Tt={class:"text-gray-300"},Pt={class:"text-white ml-1"},jt={key:1,class:"text-gray-400 text-xs"},At={class:"bg-gray-800 rounded-lg p-6"},Nt={class:"space-y-4"},Mt=["disabled"],Dt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},qt={class:"bg-gray-800 rounded-lg p-6 max-w-4xl w-full max-h-96 overflow-hidden flex flex-col"},Gt={class:"flex justify-between items-center mb-4"},Ot={class:"flex-1 overflow-y-auto"},Ft={class:"grid grid-cols-4 gap-4"},Kt=["onClick"],Bt=["src","alt"],Rt={class:"absolute bottom-1 left-1 right-1"},zt={class:"text-white text-xs bg-black bg-opacity-50 p-1 rounded truncate"};function Jt(h,t,k,o,V,C){const I=de("router-link");return n(),a("div",xe,[e("div",ve,[e("div",he,[e("div",null,[e("h1",_e,g(o.mode==="edit"?"Редактировать товар":"Создать новый товар"),1),t[33]||(t[33]=e("p",{class:"text-gray-400 mt-1"},"Заполните информацию о товаре",-1))]),e("div",we,[ue(I,{to:"/admin",class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"},{default:me(()=>t[34]||(t[34]=[ge(" ← Назад к админке ")])),_:1,__:[34]}),o.mode==="edit"?(n(),a("button",{key:0,onClick:t[0]||(t[0]=(...l)=>o.previewProduct&&o.previewProduct(...l)),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors"}," Предпросмотр ")):b("",!0)])]),o.loading?(n(),a("div",ke,t[35]||(t[35]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"},null,-1)]))):(n(),a("form",{key:1,onSubmit:t[30]||(t[30]=ce((...l)=>o.saveProduct&&o.saveProduct(...l),["prevent"])),class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},[e("div",Ie,[e("div",Ve,[t[45]||(t[45]=e("h2",{class:"text-xl font-semibold text-white mb-4"},"Основная информация",-1)),e("div",Ce,[e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Название товара * ",-1)),c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>o.form.name=l),type:"text",required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Например: Кольцо с агатом",onInput:t[2]||(t[2]=(...l)=>o.generateMetaTags&&o.generateMetaTags(...l))},null,544),[[y,o.form.name]])]),e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Артикул (SKU) ",-1)),e("div",Ue,[c(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>o.form.sku=l),type:"text",class:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Будет сгенерирован автоматически"},null,512),[[y,o.form.sku]]),e("button",{type:"button",onClick:t[4]||(t[4]=(...l)=>o.generateSKU&&o.generateSKU(...l)),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors"}," Генерировать ")])]),e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Описание * ",-1)),c(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=l=>o.form.description=l),required:"",rows:"4",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Подробное описание товара...",onInput:t[6]||(t[6]=(...l)=>o.generateMetaTags&&o.generateMetaTags(...l))},null,544),[[y,o.form.description]])]),e("div",Se,[e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Цена (рубли) * ",-1)),c(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>o.form.price=l),type:"number",required:"",min:"0",step:"0.01",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"0.00"},null,512),[[y,o.form.price,void 0,{number:!0}]])]),e("div",null,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Количество в наличии ",-1)),c(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>o.form.stock_quantity=l),type:"number",min:"0",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"0"},null,512),[[y,o.form.stock_quantity,void 0,{number:!0}]])])]),e("div",Ee,[e("div",null,[t[41]||(t[41]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Вес (граммы) ",-1)),c(e("input",{"onUpdate:modelValue":t[9]||(t[9]=l=>o.form.weight=l),type:"number",min:"0",step:"0.1",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"0.0"},null,512),[[y,o.form.weight,void 0,{number:!0}]])]),e("div",null,[t[43]||(t[43]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Тема оформления * ",-1)),c(e("select",{"onUpdate:modelValue":t[10]||(t[10]=l=>o.form.theme_id=l),required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-blue-500 focus:outline-none"},[t[42]||(t[42]=e("option",{value:""},"Выберите тему",-1)),(n(!0),a(x,null,v(o.themes,l=>(n(),a("option",{key:l.id,value:l.id},g(l.name),9,Te))),128))],512),[[be,o.form.theme_id]])])]),e("div",null,[t[44]||(t[44]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Размеры (мм) ",-1)),e("div",Pe,[e("div",null,[c(e("input",{"onUpdate:modelValue":t[11]||(t[11]=l=>o.form.dimensions.length=l),type:"number",min:"0",step:"0.1",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Длина"},null,512),[[y,o.form.dimensions.length,void 0,{number:!0}]])]),e("div",null,[c(e("input",{"onUpdate:modelValue":t[12]||(t[12]=l=>o.form.dimensions.width=l),type:"number",min:"0",step:"0.1",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Ширина"},null,512),[[y,o.form.dimensions.width,void 0,{number:!0}]])]),e("div",null,[c(e("input",{"onUpdate:modelValue":t[13]||(t[13]=l=>o.form.dimensions.height=l),type:"number",min:"0",step:"0.1",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Высота"},null,512),[[y,o.form.dimensions.height,void 0,{number:!0}]])])])])])]),e("div",je,[t[52]||(t[52]=e("h2",{class:"text-xl font-semibold text-white mb-4"},"Изображения",-1)),e("div",Ae,[e("label",Ne,[c(e("input",{"onUpdate:modelValue":t[14]||(t[14]=l=>o.form.use_matryoshka=l),type:"checkbox",class:"rounded"},null,512),[[T,o.form.use_matryoshka]]),t[46]||(t[46]=e("span",{class:"text-white font-medium"},"Использовать эффект матрёшки",-1)),t[47]||(t[47]=e("span",{class:"text-gray-400 text-sm"},"(два слоя изображений)",-1))])]),o.form.use_matryoshka?(n(),a("div",Me,[e("div",null,[t[48]||(t[48]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Внешний слой матрёшки ",-1)),e("div",De,[c(e("input",{"onUpdate:modelValue":t[15]||(t[15]=l=>o.form.image_layers.outer=l),type:"text",class:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Имя файла внешнего слоя"},null,512),[[y,o.form.image_layers.outer]]),e("button",{type:"button",onClick:t[16]||(t[16]=l=>o.openImageSelector("outer")),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors"}," Выбрать ")]),o.form.image_layers.outer?(n(),a("div",qe,[e("img",{src:o.getImageUrl(o.form.image_layers.outer),alt:"Внешний слой",class:"w-32 h-32 object-cover rounded-lg",onError:t[17]||(t[17]=(...l)=>o.handleImageError&&o.handleImageError(...l))},null,40,Ge)])):b("",!0)]),e("div",null,[t[49]||(t[49]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Внутренний слой матрёшки ",-1)),e("div",Oe,[c(e("input",{"onUpdate:modelValue":t[18]||(t[18]=l=>o.form.image_layers.inner=l),type:"text",class:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Имя файла внутреннего слоя"},null,512),[[y,o.form.image_layers.inner]]),e("button",{type:"button",onClick:t[19]||(t[19]=l=>o.openImageSelector("inner")),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors"}," Выбрать ")]),o.form.image_layers.inner?(n(),a("div",Fe,[e("img",{src:o.getImageUrl(o.form.image_layers.inner),alt:"Внутренний слой",class:"w-32 h-32 object-cover rounded-lg",onError:t[20]||(t[20]=(...l)=>o.handleImageError&&o.handleImageError(...l))},null,40,Ke)])):b("",!0)])])):(n(),a("div",Be,[t[50]||(t[50]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Галерея изображений ",-1)),e("div",Re,[(n(!0),a(x,null,v(o.form.gallery_images,(l,u)=>(n(),a("div",{key:u,class:"flex items-center space-x-4"},[c(e("input",{"onUpdate:modelValue":p=>o.form.gallery_images[u]=p,type:"text",class:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Имя файла изображения"},null,8,ze),[[y,o.form.gallery_images[u]]]),e("button",{type:"button",onClick:p=>o.openImageSelector("gallery",u),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors"}," Выбрать ",8,Je),e("button",{type:"button",onClick:p=>o.removeGalleryImage(u),class:"bg-red-600 hover:bg-red-700 text-white px-4 py-3 rounded-lg transition-colors"}," Удалить ",8,Le),l?(n(),a("div",He,[e("img",{src:o.getImageUrl(l),alt:`Изображение ${u+1}`,class:"w-full h-full object-cover rounded-lg",onError:t[21]||(t[21]=(...p)=>o.handleImageError&&o.handleImageError(...p))},null,40,Qe)])):b("",!0)]))),128)),e("button",{type:"button",onClick:t[22]||(t[22]=(...l)=>o.addGalleryImage&&o.addGalleryImage(...l)),class:"w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg transition-colors"}," + Добавить изображение ")])])),e("div",We,[t[51]||(t[51]=e("h3",{class:"text-lg font-medium text-white mb-4"},"Загрузить новые изображения",-1)),e("input",{ref:"imageUpload",type:"file",multiple:"",accept:"image/*",onChange:t[23]||(t[23]=(...l)=>o.uploadNewImages&&o.uploadNewImages(...l)),class:"hidden"},null,544),e("button",{type:"button",onClick:t[24]||(t[24]=l=>h.$refs.imageUpload.click()),class:"bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg transition-colors"}," Выбрать файлы для загрузки ")])]),e("div",Xe,[t[55]||(t[55]=e("h2",{class:"text-xl font-semibold text-white mb-4"},"SEO и мета-теги",-1)),e("div",Ye,[e("div",null,[t[53]||(t[53]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Мета-заголовок ",-1)),c(e("input",{"onUpdate:modelValue":t[25]||(t[25]=l=>o.form.meta_title=l),type:"text",maxlength:"60",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Автоматически генерируется из названия"},null,512),[[y,o.form.meta_title]]),e("div",Ze,g(o.form.meta_title.length)+"/60 символов ",1)]),e("div",null,[t[54]||(t[54]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Мета-описание ",-1)),c(e("textarea",{"onUpdate:modelValue":t[26]||(t[26]=l=>o.form.meta_description=l),rows:"3",maxlength:"160",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Автоматически генерируется из описания"},null,512),[[y,o.form.meta_description]]),e("div",$e,g(o.form.meta_description.length)+"/160 символов ",1)])])])]),e("div",et,[e("div",tt,[t[56]||(t[56]=e("h2",{class:"text-xl font-semibold text-white mb-4"},"Категории",-1)),e("div",ot,[(n(!0),a(x,null,v(o.categoryTree,l=>(n(),a("div",{key:l.id,class:"space-y-1"},[e("label",lt,[c(e("input",{"onUpdate:modelValue":t[27]||(t[27]=u=>o.form.category_ids=u),value:l.id,type:"checkbox",class:"rounded"},null,8,rt),[[T,o.form.category_ids]]),e("span",st,g(l.name),1),e("span",nt,"("+g(l.products_count||0)+")",1)]),l.children&&l.children.length?(n(),a("div",at,[(n(!0),a(x,null,v(l.children,u=>(n(),a("label",{key:u.id,class:"flex items-center space-x-3 cursor-pointer p-2 hover:bg-gray-700 rounded"},[c(e("input",{"onUpdate:modelValue":t[28]||(t[28]=p=>o.form.category_ids=p),value:u.id,type:"checkbox",class:"rounded"},null,8,it),[[T,o.form.category_ids]]),e("span",dt,"→ "+g(u.name),1),e("span",ut,"("+g(u.products_count||0)+")",1)]))),128))])):b("",!0)]))),128))]),o.categoryTree.length?b("",!0):(n(),a("div",mt," Нет доступных категорий "))]),e("div",gt,[t[59]||(t[59]=e("h2",{class:"text-xl font-semibold text-white mb-4"},"Атрибуты товара",-1)),e("div",ct,[(n(!0),a(x,null,v(o.attributes,l=>(n(),a("div",{key:l.id,class:"border border-gray-700 rounded-lg p-4"},[e("h3",bt,[e("span",null,g(l.name),1),l.is_stone?(n(),a("span",yt," Камень ")):b("",!0)]),l.values&&l.values.length?(n(),a("div",pt,[t[57]||(t[57]=e("label",{class:"block text-sm text-gray-300 mb-2"},"Стандартные значения:",-1)),e("div",ft,[(n(!0),a(x,null,v(l.values,u=>(n(),a("label",{key:u.id,class:"flex items-center space-x-2 cursor-pointer p-2 hover:bg-gray-700 rounded"},[e("input",{checked:o.isAttributeValueSelected(l.id,u.id),onChange:p=>o.toggleAttributeValue(l.id,u.id),type:"checkbox",class:"rounded"},null,40,xt),e("span",vt,g(u.value),1)]))),128))])])):b("",!0),e("div",null,[t[58]||(t[58]=e("label",{class:"block text-sm text-gray-300 mb-2"},"Или введите кастомное значение:",-1)),e("input",{value:o.getCustomAttributeValue(l.id),onInput:u=>h.addCustomAttributeValue(l.id,u.target.value),type:"text",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:`Кастомное значение для ${l.name}`},null,40,ht)])]))),128))]),o.attributes.length?b("",!0):(n(),a("div",_t," Нет доступных атрибутов "))]),e("div",wt,[t[65]||(t[65]=e("h2",{class:"text-xl font-semibold text-white mb-4"},"Предпросмотр",-1)),e("div",kt,[e("div",null,[t[60]||(t[60]=e("span",{class:"text-gray-400"},"Название:",-1)),e("span",It,g(o.form.name||"Не указано"),1)]),e("div",null,[t[61]||(t[61]=e("span",{class:"text-gray-400"},"Цена:",-1)),e("span",Vt,g(o.formatPrice(o.form.price))+" ₽",1)]),e("div",null,[t[62]||(t[62]=e("span",{class:"text-gray-400"},"Тема:",-1)),e("span",Ct,g(o.getThemeName(o.form.theme_id)),1)]),e("div",null,[t[63]||(t[63]=e("span",{class:"text-gray-400"},"Категории:",-1)),e("div",Ut,[(n(!0),a(x,null,v(o.form.category_ids,l=>(n(),a("span",{key:l,class:"inline-block bg-blue-600 text-white px-2 py-1 rounded text-xs mr-1 mb-1"},g(o.getCategoryName(l)),1))),128)),o.form.category_ids.length?b("",!0):(n(),a("span",St,"Не выбраны"))])]),e("div",null,[t[64]||(t[64]=e("span",{class:"text-gray-400"},"Атрибуты:",-1)),e("div",Et,[h.values.valueIds.length>0||h.values.customValue?(n(!0),a(x,{key:0},v(Object.entries(o.form.attribute_values),([l,u])=>(n(),a("div",{key:l,class:"text-xs"},[e("span",Tt,g(o.getAttributeName(l))+":",1),e("span",Pt,g(o.getAttributeDisplayValue(l,u)),1)]))),128)):b("",!0),Object.keys(o.form.attribute_values).length?b("",!0):(n(),a("span",jt," Не указаны "))])])])]),e("div",At,[e("div",Nt,[e("button",{type:"submit",class:"w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg transition-colors font-medium",disabled:o.saving},g(o.saving?"Сохранение...":o.mode==="edit"?"Обновить товар":"Создать товар"),9,Mt),o.mode==="edit"?(n(),a("button",{key:0,type:"button",onClick:t[29]||(t[29]=(...l)=>o.deleteProduct&&o.deleteProduct(...l)),class:"w-full bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg transition-colors"}," Удалить товар ")):b("",!0)])])])],32))]),o.showImageSelector?(n(),a("div",Dt,[e("div",qt,[e("div",Gt,[t[66]||(t[66]=e("h3",{class:"text-xl text-white"},"Выберите изображение",-1)),e("button",{onClick:t[31]||(t[31]=(...l)=>o.closeImageSelector&&o.closeImageSelector(...l)),class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"}," Закрыть ")]),e("div",Ot,[e("div",Ft,[(n(!0),a(x,null,v(o.availableImages,l=>(n(),a("div",{key:l.filename,class:"relative cursor-pointer group",onClick:u=>o.selectImage(l.filename)},[e("img",{src:o.getImageUrl(l.filename),alt:l.filename,class:"w-full h-24 object-cover rounded-lg group-hover:opacity-75 transition-opacity",onError:t[32]||(t[32]=(...u)=>o.handleImageError&&o.handleImageError(...u))},null,40,Bt),t[67]||(t[67]=e("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-25 rounded-lg transition-opacity"},null,-1)),e("div",Rt,[e("p",zt,g(l.filename),1)])],8,Kt))),128))])])])])):b("",!0)])}const Ht=se(fe,[["render",Jt],["__scopeId","data-v-0e473d92"]]);export{Ht as default};
