import{_ as T,g as h,o as K,a,c as n,b as t,s as q,q as z,F as j,l as D,m as v,t as x,e as G,n as U,h as W,p as O,i as J,j as w,v as A,z as X,r as Q,d as R,w as E,k as Y,A as B,u as Z,x as $,y as ee}from"./main-1c80cd6b.js";const te={name:"ImageUpload",emits:["selected","uploaded"],setup(y,{emit:e}){const m=h(null),o=h([]),i=h([]),p=h(!1),l=h(!1),_=async()=>{try{const c=await U.get("/admin/images");o.value=c.data.images||[]}catch(c){console.error("Ошибка загрузки изображений:",c)}},f=()=>{p.value||m.value.click()},s=c=>{const g=Array.from(c.target.files);k(g)},b=c=>{l.value=!1;const g=Array.from(c.dataTransfer.files);k(g)},k=async c=>{var L,N;if(c.length===0)return;p.value=!0;const g=[];for(const P of c){if(!P.type.startsWith("image/")){alert(`Файл ${P.name} не является изображением`);continue}if(P.size>5*1024*1024){alert(`Файл ${P.name} превышает 5MB`);continue}try{const I=new FormData;I.append("image",P);const S=await U.post("/admin/images/upload",I,{headers:{"Content-Type":"multipart/form-data"},timeout:3e4});g.push(S.data.url)}catch(I){console.error("Ошибка загрузки файла:",I);const S=((N=(L=I.response)==null?void 0:L.data)==null?void 0:N.message)||"Неизвестная ошибка";alert(`Ошибка загрузки ${P.name}: ${S}`)}}p.value=!1,g.length>0&&(await _(),e("uploaded",g))},V=c=>{const g=i.value.indexOf(c);g>-1?i.value.splice(g,1):i.value.push(c)},F=c=>{const g=i.value.indexOf(c);g>-1&&i.value.splice(g,1)},C=async c=>{try{await navigator.clipboard.writeText(c),alert("URL скопирован в буфер обмена")}catch(g){console.error("Ошибка копирования:",g)}},M=c=>c.split("/").pop();return K(()=>{_()}),{fileInput:m,images:o,selectedUrls:i,uploading:p,dragOver:l,openFileDialog:f,handleFileSelect:s,handleDrop:b,selectImage:V,removeSelection:F,copyUrl:C,getFilename:M}}},oe={class:"image-upload"},se={key:0,class:"py-4"},le={key:1},re={key:0,class:"mt-6"},ae={class:"grid grid-cols-3 md:grid-cols-6 gap-4"},ne=["onClick"],de=["src","alt"],ie={class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center"},ce=["onClick"],ue={key:0,class:"absolute top-1 right-1"},me={key:1,class:"mt-4 p-4 bg-gray-800 rounded-lg"},ge={class:"text-white font-medium mb-2"},ye={class:"flex flex-wrap gap-2"},be=["onClick"],pe={class:"mt-3 flex space-x-2"};function fe(y,e,m,o,i,p){return a(),n("div",oe,[t("div",{onClick:e[1]||(e[1]=(...l)=>o.openFileDialog&&o.openFileDialog(...l)),onDragover:e[2]||(e[2]=q(()=>{},["prevent"])),onDrop:e[3]||(e[3]=q((...l)=>o.handleDrop&&o.handleDrop(...l),["prevent"])),class:z(["border-2 border-dashed border-gray-600 rounded-lg p-6 text-center cursor-pointer hover:border-gray-500 transition-colors",{"border-blue-500 bg-blue-50/10":o.dragOver}])},[t("input",{ref:"fileInput",type:"file",accept:"image/*",multiple:"",onChange:e[0]||(e[0]=(...l)=>o.handleFileSelect&&o.handleFileSelect(...l)),class:"hidden"},null,544),o.uploading?(a(),n("div",se,e[6]||(e[6]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-2"},null,-1),t("p",{class:"text-gray-400"},"Загружаем изображения...",-1)]))):(a(),n("div",le,e[7]||(e[7]=[t("svg",{class:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),t("p",{class:"text-gray-300 font-medium"},"Нажмите или перетащите изображения",-1),t("p",{class:"text-gray-400 text-sm mt-1"},"PNG, JPG, GIF, WebP до 5MB",-1)])))],34),o.images.length>0?(a(),n("div",re,[e[9]||(e[9]=t("h4",{class:"text-white font-medium mb-3"},"Загруженные изображения:",-1)),t("div",ae,[(a(!0),n(j,null,D(o.images,l=>(a(),n("div",{key:l.url,class:"relative group cursor-pointer",onClick:_=>o.selectImage(l.url)},[t("img",{src:l.url,alt:l.filename,class:z(["w-full h-20 object-cover rounded-lg border-2 border-transparent hover:border-blue-500 transition-colors",{"border-blue-500 ring-2 ring-blue-500":o.selectedUrls.includes(l.url)}])},null,10,de),t("div",ie,[t("button",{onClick:q(_=>o.copyUrl(l.url),["stop"]),class:"bg-white text-black px-2 py-1 rounded text-xs"}," Копировать URL ",8,ce)]),o.selectedUrls.includes(l.url)?(a(),n("div",ue,e[8]||(e[8]=[t("svg",{class:"w-5 h-5 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"})],-1)]))):v("",!0)],8,ne))),128))])])):v("",!0),o.selectedUrls.length>0?(a(),n("div",me,[t("h5",ge,"Выбрано изображений: "+x(o.selectedUrls.length),1),t("div",ye,[(a(!0),n(j,null,D(o.selectedUrls,l=>(a(),n("span",{key:l,class:"bg-blue-600 text-white px-3 py-1 rounded-full text-sm flex items-center"},[G(x(o.getFilename(l))+" ",1),t("button",{onClick:_=>o.removeSelection(l),class:"ml-2 text-blue-200 hover:text-white"},"×",8,be)]))),128))]),t("div",pe,[t("button",{onClick:e[4]||(e[4]=l=>y.$emit("selected",o.selectedUrls)),class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm"}," Использовать выбранные "),t("button",{onClick:e[5]||(e[5]=l=>o.selectedUrls=[]),class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded text-sm"}," Очистить выбор ")])])):v("",!0)])}const xe=T(te,[["render",fe]]),ve={name:"QuickAddModal",props:{type:{type:String,required:!0,validator:y=>["theme","category","attribute"].includes(y)}},emits:["close","added"],setup(y,{emit:e}){const m=h(!1),o=h(""),i=W({name:"",slug:""}),p=O(()=>!(!i.name||y.type==="category"&&!i.slug));return J(()=>i.name,f=>{y.type==="category"&&f&&(i.slug=f.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim("-"))}),{loading:m,error:o,form:i,isValid:p,save:async()=>{var f,s,b,k,V,F;if(p.value){m.value=!0,o.value="";try{const C=`/admin/${y.type}s`,M=y.type==="category"?{name:i.name,slug:i.slug}:{name:i.name},c=await U.post(C,M),g=c.data[y.type]||c.data.data||{id:Date.now(),name:i.name,slug:i.slug};e("added",g,y.type)}catch(C){console.error("Ошибка создания:",C),o.value=((s=(f=C.response)==null?void 0:f.data)==null?void 0:s.message)||((F=(V=(k=(b=C.response)==null?void 0:b.data)==null?void 0:k.errors)==null?void 0:V.name)==null?void 0:F[0])||"Ошибка создания"}finally{m.value=!1}}},getEntityName:f=>({theme:"тему",category:"категорию",attribute:"атрибут"})[f]||f}}},he={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},_e={class:"bg-gray-800 rounded-lg max-w-md w-full"},we={class:"p-6"},ke={class:"text-xl font-semibold mb-6 text-white"},Ce={class:"block text-sm font-medium mb-2 text-white"},Ue=["placeholder"],Pe={key:0},Ae={key:1,class:"text-gray-400 text-sm"},Ie={key:2,class:"text-gray-400 text-sm"},Ve={key:3,class:"text-gray-400 text-sm"},Fe={key:4,class:"text-red-400 text-sm"},je={class:"flex justify-end space-x-3 pt-4"},De=["disabled"],Me=["disabled"];function Se(y,e,m,o,i,p){return a(),n("div",he,[t("div",_e,[t("div",we,[t("h3",ke," Добавить "+x(o.getEntityName(m.type)),1),t("form",{onSubmit:e[4]||(e[4]=q((...l)=>o.save&&o.save(...l),["prevent"])),class:"space-y-4"},[t("div",null,[t("label",Ce," Название "+x(o.getEntityName(m.type).toLowerCase())+" * ",1),w(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>o.form.name=l),type:"text",required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:`Введите название ${o.getEntityName(m.type).toLowerCase()}`,onKeyup:e[1]||(e[1]=X((...l)=>o.save&&o.save(...l),["enter"]))},null,40,Ue),[[A,o.form.name]])]),m.type==="category"?(a(),n("div",Pe,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium mb-2 text-white"}," URL-адрес (slug) * ",-1)),w(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>o.form.slug=l),type:"text",required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"url-slug"},null,512),[[A,o.form.slug]]),e[6]||(e[6]=t("p",{class:"text-gray-400 text-xs mt-1"}," Используется в URL. Только латиница, цифры и дефисы. ",-1))])):v("",!0),m.type==="theme"?(a(),n("div",Ae,e[7]||(e[7]=[t("p",null,"Темы используются для стилистической группировки товаров (например: Минимализм, Готика, Винтаж).",-1)]))):v("",!0),m.type==="category"?(a(),n("div",Ie,e[8]||(e[8]=[t("p",null,"Категории определяют тип украшения (например: Кольца, Браслеты, Серьги).",-1)]))):v("",!0),m.type==="attribute"?(a(),n("div",Ve,e[9]||(e[9]=[t("p",null,"Атрибуты описывают материалы и камни (например: агат, серебро, золото).",-1)]))):v("",!0),o.error?(a(),n("div",Fe,x(o.error),1)):v("",!0),t("div",je,[t("button",{type:"button",onClick:e[3]||(e[3]=l=>y.$emit("close")),class:"px-4 py-2 text-gray-400 hover:text-white transition-colors",disabled:o.loading}," Отмена ",8,De),t("button",{type:"submit",disabled:!o.isValid||o.loading,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white px-6 py-2 rounded-lg font-medium transition-colors"},x(o.loading?"Создание...":"Создать"),9,Me)])],32)])])])}const qe=T(ve,[["render",Se]]),Le={name:"ProductCreate",components:{ImageUpload:xe,QuickAddModal:qe},setup(){const y=$(),e=ee(),m=h(!1),o=O(()=>y.params.id?"edit":"create"),i=h([]),p=h([]),l=h([]),_=h(!1),f=h(""),s=W({id:null,name:"",description:"",price:"",theme_id:"",use_matryoshka:!1,image_layers:{outer:"",inner:""},gallery_images:[],category_ids:[],attribute_ids:[]}),b=O(()=>s.name&&s.description&&s.price&&s.theme_id),k=async()=>{await Promise.all([V(),F(),C()]),o.value==="edit"&&await M()},V=async()=>{var r,u;try{console.log("ProductCreate: Загружаем темы...");const d=await U.get("/admin/themes");console.log("ProductCreate: Ответ API тем:",d),i.value=d.data||[],console.log("ProductCreate: Темы загружены:",i.value)}catch(d){console.error("ProductCreate: Ошибка загрузки тем:",d),alert("Ошибка загрузки тем: "+(((u=(r=d.response)==null?void 0:r.data)==null?void 0:u.message)||"Неизвестная ошибка"))}},F=async()=>{var r,u;try{console.log("ProductCreate: Загружаем категории...");const d=await U.get("/admin/categories");console.log("ProductCreate: Ответ API категорий:",d),p.value=d.data||[],console.log("ProductCreate: Категории загружены:",p.value)}catch(d){console.error("ProductCreate: Ошибка загрузки категорий:",d),alert("Ошибка загрузки категорий: "+(((u=(r=d.response)==null?void 0:r.data)==null?void 0:u.message)||"Неизвестная ошибка"))}},C=async()=>{var r,u;try{console.log("ProductCreate: Загружаем атрибуты...");const d=await U.get("/admin/attributes");console.log("ProductCreate: Ответ API атрибутов:",d),l.value=d.data||[],console.log("ProductCreate: Атрибуты загружены:",l.value)}catch(d){console.error("ProductCreate: Ошибка загрузки атрибутов:",d),alert("Ошибка загрузки атрибутов: "+(((u=(r=d.response)==null?void 0:r.data)==null?void 0:u.message)||"Неизвестная ошибка"))}},M=async()=>{try{m.value=!0;const u=(await U.get(`/admin/products/${y.params.id}`)).data;Object.assign(s,{id:u.id,name:u.name,description:u.description,price:u.price,theme_id:u.theme_id,use_matryoshka:u.use_matryoshka,image_layers:u.image_layers||{outer:"",inner:""},gallery_images:u.gallery_images||[],category_ids:u.categories.map(d=>d.id),attribute_ids:u.attributes.map(d=>d.id)})}catch(r){console.error("Ошибка загрузки товара:",r),alert("Товар не найден"),e.push("/admin")}finally{m.value=!1}},c=async()=>{var r,u;m.value=!0;try{const d={...s,price:parseFloat(s.price)};o.value==="create"?(await U.post("/admin/products",d),alert("Товар успешно создан!")):(await U.put(`/admin/products/${s.id}`,d),alert("Товар успешно обновлен!")),e.push("/admin")}catch(d){console.error("Ошибка сохранения товара:",d),alert(((u=(r=d.response)==null?void 0:r.data)==null?void 0:u.message)||"Ошибка сохранения")}finally{m.value=!1}},g=r=>{s.gallery_images.push(...r)},L=r=>{s.gallery_images.push(...r)},N=()=>{s.gallery_images.push("")},P=r=>{s.gallery_images.splice(r,1)},I=r=>{f.value=r,_.value=!0},S=(r,u)=>{switch(u){case"theme":i.value.push(r),s.theme_id=r.id;break;case"category":p.value.push(r),s.category_ids.push(r.id);break;case"attribute":l.value.push(r),s.attribute_ids.push(r.id);break}_.value=!1},H=r=>new Intl.NumberFormat("ru-RU").format(r);return K(()=>{k()}),{loading:m,mode:o,themes:i,categories:p,attributes:l,quickAddOpen:_,quickAddType:f,form:s,isFormValid:b,saveProduct:c,onImagesSelected:g,onImagesUploaded:L,addGalleryImage:N,removeGalleryImage:P,showQuickAdd:I,onQuickAdded:S,formatPrice:H}}},Ne={class:"product-create min-h-screen bg-gray-900 py-8"},Qe={class:"max-w-6xl mx-auto px-4"},Re={class:"flex items-center justify-between mb-8"},Be={class:"text-3xl font-bold text-white"},Ge={class:"lg:col-span-2 space-y-6"},Oe={class:"bg-gray-800 rounded-xl p-6"},Te={class:"space-y-4"},ze={class:"bg-gray-800 rounded-xl p-6"},Ee={class:"space-y-4"},Ke={class:"flex items-center justify-between mb-2"},We=["value"],He={class:"flex items-center justify-between mb-2"},Je={class:"space-y-2 max-h-32 overflow-y-auto bg-gray-700 rounded-lg p-3"},Xe=["value"],Ye={class:"text-white"},Ze={class:"flex items-center justify-between mb-2"},$e={class:"space-y-2 max-h-32 overflow-y-auto bg-gray-700 rounded-lg p-3"},et=["value"],tt={class:"text-white"},ot={key:0,class:"ml-2 text-xs text-green-400"},st={class:"bg-gray-800 rounded-xl p-6"},lt={class:"space-y-4"},rt={class:"flex items-center"},at={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},nt={class:"space-y-6"},dt={class:"bg-gray-800 rounded-xl p-6"},it={key:0,class:"mt-6"},ct={class:"space-y-2"},ut=["src","alt"],mt=["onUpdate:modelValue"],gt=["onClick"],yt={class:"bg-gray-800 rounded-xl p-6"},bt={class:"bg-gray-900 rounded-lg p-4"},pt={key:0,class:"mb-3"},ft=["src","alt"],xt={class:"text-white font-medium"},vt={class:"text-gray-400 text-sm mt-1"},ht={class:"flex items-center justify-between mt-3"},_t={class:"text-lg font-bold text-blue-400"},wt={key:0,class:"text-xs bg-purple-600 text-white px-2 py-1 rounded"},kt={class:"bg-gray-800 rounded-xl p-6"},Ct={class:"space-y-3"},Ut=["disabled"];function Pt(y,e,m,o,i,p){const l=Q("router-link"),_=Q("ImageUpload"),f=Q("QuickAddModal");return a(),n("div",Ne,[t("div",Qe,[t("div",Re,[t("div",null,[t("h1",Be,x(o.mode==="edit"?"Редактировать товар":"Создать новый товар"),1),e[15]||(e[15]=t("p",{class:"text-gray-400 mt-1"},"Заполните информацию о товаре",-1))]),R(l,{to:"/admin",class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"},{default:E(()=>e[16]||(e[16]=[G(" ← Назад к админке ")])),_:1,__:[16]})]),t("form",{onSubmit:e[13]||(e[13]=q((...s)=>o.saveProduct&&o.saveProduct(...s),["prevent"])),class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},[t("div",Ge,[t("div",Oe,[e[20]||(e[20]=t("h2",{class:"text-xl font-semibold text-white mb-4"},"Основная информация",-1)),t("div",Te,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-white mb-2"}," Название товара * ",-1)),w(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.form.name=s),type:"text",required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Например: Кольцо с агатом"},null,512),[[A,o.form.name]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-white mb-2"}," Описание * ",-1)),w(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.description=s),required:"",rows:"4",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Подробное описание товара..."},null,512),[[A,o.form.description]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-white mb-2"}," Цена (рубли) * ",-1)),w(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.price=s),type:"number",required:"",min:"0",step:"0.01",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"2500.00"},null,512),[[A,o.form.price]])])])]),t("div",ze,[e[25]||(e[25]=t("h2",{class:"text-xl font-semibold text-white mb-4"},"Категории и свойства",-1)),t("div",Ee,[t("div",null,[t("div",Ke,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-white"}," Тема * ",-1)),t("button",{type:"button",onClick:e[3]||(e[3]=s=>o.showQuickAdd("theme")),class:"text-blue-400 hover:text-blue-300 text-sm"}," + Добавить тему ")]),w(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.form.theme_id=s),required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-blue-500 focus:outline-none"},[e[22]||(e[22]=t("option",{value:""},"Выберите тему",-1)),(a(!0),n(j,null,D(o.themes,s=>(a(),n("option",{key:s.id,value:s.id},x(s.name),9,We))),128))],512),[[Y,o.form.theme_id]])]),t("div",null,[t("div",He,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-white"}," Категории ",-1)),t("button",{type:"button",onClick:e[5]||(e[5]=s=>o.showQuickAdd("category")),class:"text-blue-400 hover:text-blue-300 text-sm"}," + Добавить категорию ")]),t("div",Je,[(a(!0),n(j,null,D(o.categories,s=>(a(),n("label",{key:s.id,class:"flex items-center"},[w(t("input",{"onUpdate:modelValue":e[6]||(e[6]=b=>o.form.category_ids=b),value:s.id,type:"checkbox",class:"mr-3 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500"},null,8,Xe),[[B,o.form.category_ids]]),t("span",Ye,x(s.name),1)]))),128))])]),t("div",null,[t("div",Ze,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-white"}," Атрибуты (камни, металлы) ",-1)),t("button",{type:"button",onClick:e[7]||(e[7]=s=>o.showQuickAdd("attribute")),class:"text-blue-400 hover:text-blue-300 text-sm"}," + Добавить атрибут ")]),t("div",$e,[(a(!0),n(j,null,D(o.attributes,s=>(a(),n("label",{key:s.id,class:"flex items-center"},[w(t("input",{"onUpdate:modelValue":e[8]||(e[8]=b=>o.form.attribute_ids=b),value:s.id,type:"checkbox",class:"mr-3 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500"},null,8,et),[[B,o.form.attribute_ids]]),t("span",tt,x(s.name),1),s.is_stone?(a(),n("span",ot,"(камень)")):v("",!0)]))),128))])])])]),t("div",st,[e[29]||(e[29]=t("h2",{class:"text-xl font-semibold text-white mb-4"},"Эффект матрёшки",-1)),t("div",lt,[t("label",rt,[w(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>o.form.use_matryoshka=s),type:"checkbox",class:"mr-3 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500"},null,512),[[B,o.form.use_matryoshka]]),e[26]||(e[26]=t("span",{class:"text-white font-medium"},"Использовать эффект матрёшки",-1))]),o.form.use_matryoshka?(a(),n("div",at,[t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-white mb-2"}," Внешний слой ",-1)),w(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>o.form.image_layers.outer=s),type:"url",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"URL внешнего слоя"},null,512),[[A,o.form.image_layers.outer]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-white mb-2"}," Внутренний слой ",-1)),w(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>o.form.image_layers.inner=s),type:"url",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"URL внутреннего слоя"},null,512),[[A,o.form.image_layers.inner]])])])):v("",!0)])])]),t("div",nt,[t("div",dt,[e[31]||(e[31]=t("h2",{class:"text-xl font-semibold text-white mb-4"},"Изображения товара",-1)),R(_,{onSelected:o.onImagesSelected,onUploaded:o.onImagesUploaded},null,8,["onSelected","onUploaded"]),o.form.gallery_images.length>0?(a(),n("div",it,[e[30]||(e[30]=t("h4",{class:"text-white font-medium mb-3"},"Галерея товара:",-1)),t("div",ct,[(a(!0),n(j,null,D(o.form.gallery_images,(s,b)=>(a(),n("div",{key:b,class:"flex items-center space-x-3 bg-gray-700 rounded-lg p-3"},[t("img",{src:s,alt:`Изображение ${b+1}`,class:"w-12 h-12 object-cover rounded"},null,8,ut),w(t("input",{"onUpdate:modelValue":k=>o.form.gallery_images[b]=k,type:"url",class:"flex-1 bg-gray-600 border border-gray-500 rounded px-3 py-2 text-white text-sm",placeholder:"URL изображения"},null,8,mt),[[A,o.form.gallery_images[b]]]),t("button",{type:"button",onClick:k=>o.removeGalleryImage(b),class:"text-red-400 hover:text-red-300"}," ✕ ",8,gt)]))),128))]),t("button",{type:"button",onClick:e[12]||(e[12]=(...s)=>o.addGalleryImage&&o.addGalleryImage(...s)),class:"mt-3 text-blue-400 hover:text-blue-300 text-sm"}," + Добавить изображение вручную ")])):v("",!0)]),t("div",yt,[e[32]||(e[32]=t("h2",{class:"text-xl font-semibold text-white mb-4"},"Предварительный просмотр",-1)),t("div",bt,[o.form.gallery_images[0]?(a(),n("div",pt,[t("img",{src:o.form.gallery_images[0],alt:o.form.name,class:"w-full h-32 object-cover rounded"},null,8,ft)])):v("",!0),t("h3",xt,x(o.form.name||"Название товара"),1),t("p",vt,x(o.form.description||"Описание товара"),1),t("div",ht,[t("span",_t,x(o.form.price?o.formatPrice(o.form.price):"0")+" ₽ ",1),o.form.use_matryoshka?(a(),n("span",wt," Матрёшка ")):v("",!0)])])]),t("div",kt,[t("div",Ct,[t("button",{type:"submit",disabled:o.loading||!o.isFormValid,class:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white py-3 rounded-lg font-medium transition-colors"},x(o.loading?"Сохранение...":o.mode==="edit"?"Обновить товар":"Создать товар"),9,Ut),R(l,{to:"/admin",class:"block w-full bg-gray-600 hover:bg-gray-700 text-white py-3 rounded-lg font-medium text-center transition-colors"},{default:E(()=>e[33]||(e[33]=[G(" Отмена ")])),_:1,__:[33]})])])])],32)]),o.quickAddOpen?(a(),Z(f,{key:0,type:o.quickAddType,onClose:e[14]||(e[14]=s=>o.quickAddOpen=!1),onAdded:o.onQuickAdded},null,8,["type","onAdded"])):v("",!0)])}const It=T(Le,[["render",Pt]]);export{It as default};
